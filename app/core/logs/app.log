2024-12-23 17:00:46,590 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-23 17:03:28,066 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-23 17:08:25,753 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-24 19:01:45,401 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-24 19:18:56,154 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-24 19:42:00,692 - SchoolAttendanceLogger - WARNING - Failed login attempt for email: mikailismail260@gmail.com&
2024-12-24 19:42:08,553 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-24 20:00:48,205 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-24 20:56:52,836 - SchoolAttendanceLogger - WARNING - Expired token attempt: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwicm9sZSI6InN1cGVyX2FkbWluIiwiZXhwIjoxNzM1MDYxNDQ4LCJ0eXBlIjoiYWNjZXNzIn0.jm5vwr9gVW1yWU7IGJKcT0OcPnBlAlMFc8r_-N2kfSM
2024-12-25 06:35:04,943 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 07:21:25,031 - SchoolAttendanceLogger - WARNING - Failed login attempt for email: mikailismail260@gmaiil.com
2024-12-26 07:22:37,681 - SchoolAttendanceLogger - WARNING - Failed login attempt for email: mikailismail260@gmaiil.com
2024-12-26 07:24:34,839 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 07:38:38,442 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 07:43:24,686 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 07:49:17,711 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 07:57:40,945 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 08:32:11,531 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 15:11:15,224 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 15:18:31,331 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 15:48:15,586 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 20:34:33,159 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 21:05:47,707 - SchoolAttendanceLogger - INFO - User authenticated: mikailismail260@gmail.com
2024-12-26 21:23:10,532 - SchoolAttendanceLogger - INFO - New school admin registered: initiativetechbridge@gmail.com
2024-12-26 21:35:07,787 - SchoolAttendanceLogger - INFO - User authenticated: initiativetechbridge@gmail.com
2024-12-26 22:09:17,077 - SchoolAttendanceLogger - INFO - User authenticated: initiativetechbridge@gmail.com
2024-12-27 10:40:36,968 - SchoolAttendanceLogger - INFO - User authenticated: initiativetechbridge@gmail.com
2024-12-27 23:51:23,064 - SchoolAttendanceLogger - INFO - User authenticated: initiativetechbridge@gmail.com
{"timestamp": "2024-12-28T11:53:13.031368", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-28T19:04:25.202519", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-28T19:37:09.492704", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-28T19:38:53.756477", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-28T20:28:47.773093", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-28T20:59:39.634547", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-29T08:22:13.411144", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-29T09:01:52.067594", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-29T11:02:20.286874", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-29T16:36:44.658875", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-29T17:40:08.951105", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-29T18:19:21.565249", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: initiativetechbridge@gmail.com"}
{"timestamp": "2024-12-29T18:22:35.835222", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 108, "message": "Failed login attempt for email: fatumaosman2@gmail.com"}
{"timestamp": "2024-12-29T19:06:38.672592", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: mikailismail260@gmail.com"}
{"timestamp": "2024-12-29T19:06:38.999346", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: mikailismail260@gmail.com"}
{"timestamp": "2024-12-29T19:07:59.891367", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: mikailismail260@gmail.com"}
{"timestamp": "2024-12-29T19:08:33.900633", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "generate_registration_number", "line": 40, "message": "Generated new school registration number: SCH-2024-003"}
{"timestamp": "2024-12-29T19:15:21.820656", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "generate_registration_number", "line": 40, "message": "Generated new school registration number: SCH-2024-003"}
{"timestamp": "2024-12-29T19:33:49.689465", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "generate_registration_number", "line": 42, "message": "Generated new school registration number: SCH-2024-001"}
{"timestamp": "2024-12-29T19:49:53.749504", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: mikailismail260@gmail.com"}
{"timestamp": "2024-12-29T19:50:38.673306", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "generate_registration_number", "line": 42, "message": "Generated new school registration number: SCH-2024-001"}
{"timestamp": "2024-12-29T19:53:36.860633", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "generate_registration_number", "line": 42, "message": "Generated new school registration number: SCH-2024-001"}
{"timestamp": "2024-12-29T20:00:45.737753", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "generate_registration_number", "line": 42, "message": "Generated new school registration number: SCH-2024-001"}
{"timestamp": "2024-12-30T10:24:20.612021", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T10:30:20.976656", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 108, "message": "Failed login attempt for email: abdiazizismail51@gmail.com"}
{"timestamp": "2024-12-30T12:07:28.894193", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 108, "message": "Failed login attempt for email: abdiazizismail51@gmail.com"}
{"timestamp": "2024-12-30T12:07:55.824732", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T12:17:20.238271", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 149, "message": "Failed to create school: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint \"schools_registration_number_key\"\nDETAIL:  Key (registration_number)=(SCH-2024-001) already exists.\n[SQL: INSERT INTO schools (name, email, phone, registration_number, school_type, website, status, address, county, postal_code, class_system, class_range, extra_info, is_active, created_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::JSON, $13::JSON, $14::BOOLEAN, $15::TIMESTAMP WITH TIME ZONE) RETURNING schools.id, schools.updated_at]\n[parameters: ('Green Academy', 'abdiazizismail51@gmail.com', '+254723423256', 'SCH-2024-001', <SchoolType.PRIMARY: 'primary'>, None, <SchoolStatus.ACTIVE: 'active'>, '123 Learning Road, Nairobi', 'Nairobi', '00100', '8-4-4', '{\"lower_bound\": 1, \"upper_bound\": 8}', '{\"motto\": \"Excellence in Education\", \"founded\": 1995}', True, datetime.datetime(2024, 12, 30, 12, 17, 19, 300535))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2024-12-30T12:28:47.675427", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 209, "message": "Failed to create school: 'SchoolService' object has no attribute '_store_password_reset_token'"}
{"timestamp": "2024-12-30T12:38:40.445912", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T12:39:14.340188", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 191, "message": "Created new school: Green Academy with registration number: SCH-2024-003"}
{"timestamp": "2024-12-30T13:40:19.714980", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T13:42:04.499560", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 203, "message": "Failed to create school: module 'app.services.email_service' has no attribute 'send_school_admin_credentials'"}
{"timestamp": "2024-12-30T14:11:36.587525", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T14:15:17.780625", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 189, "message": "Failed to send welcome email to school: county High school"}
{"timestamp": "2024-12-30T14:15:17.783003", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 191, "message": "Created new school: county High school with registration number: SCH-2024-005"}
{"timestamp": "2024-12-30T14:57:13.288268", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 129, "message": "User authenticated: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T15:03:27.890480", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 189, "message": "Failed to send welcome email to school: Balambala  High school"}
{"timestamp": "2024-12-30T15:03:27.915425", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 191, "message": "Created new school: Balambala  High school with registration number: SCH-2024-006"}
{"timestamp": "2024-12-30T15:06:14.368665", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 108, "message": "Failed login attempt for email: maryannn2022@gmail.@gmail.com"}
{"timestamp": "2024-12-30T15:15:10.696259", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 108, "message": "Failed login attempt for email: maryannn2022@gmail.@gmail.com"}
{"timestamp": "2024-12-30T15:31:39.502606", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 108, "message": "Failed login attempt for email: maryannn2022@gmail.com"}
{"timestamp": "2024-12-30T15:32:49.280600", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 108, "message": "Failed login attempt for email: maryannn2022@gmail.com"}
{"timestamp": "2024-12-30T16:17:02.228023", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 108, "message": "Failed login attempt for email: maryannn2022@gmail.com"}
{"timestamp": "2024-12-30T18:12:44.350724", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 85, "message": "Failed login attempt for email: maryannn2022@gmail.com"}
{"timestamp": "2024-12-30T18:15:05.933224", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 83, "message": "Invalid password for email: maryannn2022@gmail.com"}
{"timestamp": "2024-12-30T18:15:05.936973", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 126, "message": "Authentication error: 401: Invalid credentials"}
{"timestamp": "2024-12-30T18:17:08.599387", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 83, "message": "Invalid password for email: safwaismail8@gmail.com"}
{"timestamp": "2024-12-30T18:17:08.631483", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 126, "message": "Authentication error: 401: Invalid credentials"}
{"timestamp": "2024-12-30T18:17:46.703252", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 126, "message": "Authentication error: 'AuthService' object has no attribute 'create_access_token'"}
{"timestamp": "2024-12-30T18:20:40.339288", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 140, "message": "Authentication error: 'Settings' object has no attribute 'PRODUCTION'"}
{"timestamp": "2024-12-30T18:28:53.184083", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 152, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T18:35:10.968400", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 121, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T18:48:38.809575", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 173, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T19:02:37.235317", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 173, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T19:12:00.561574", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 173, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T19:17:36.112725", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 173, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T19:20:15.826757", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 173, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T19:42:57.122730", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 173, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T20:03:08.138093", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 166, "message": "Authentication error: 'str' object has no attribute 'headers'"}
{"timestamp": "2024-12-30T20:17:02.581214", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 166, "message": "Authentication error: 'str' object has no attribute 'headers'"}
{"timestamp": "2024-12-30T20:20:12.133086", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 166, "message": "Authentication error: 'str' object has no attribute 'headers'"}
{"timestamp": "2024-12-30T20:23:40.624495", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 145, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T20:30:49.889937", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 110, "message": "Failed authentication attempt for user: maryannn2022@gmail.com"}
{"timestamp": "2024-12-30T20:31:09.122028", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 145, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-30T20:44:46.744809", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "get_current_user", "line": 247, "message": "Unexpected error in get_current_user: type object 'RevokedToken' has no attribute 'token'"}
{"timestamp": "2024-12-30T20:50:04.748280", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 105, "message": "Token does not contain JTI claim"}
{"timestamp": "2024-12-30T20:51:36.656326", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 105, "message": "Token does not contain JTI claim"}
{"timestamp": "2024-12-30T21:11:13.691609", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 92, "message": "Token verification error: Signature has expired."}
{"timestamp": "2024-12-30T21:11:13.724766", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "get_current_user", "line": 237, "message": "Unexpected error in get_current_user: 401: Invalid token"}
{"timestamp": "2024-12-30T21:11:59.062403", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 190, "message": "Authentication error: name 'set_auth_cookies' is not defined"}
{"timestamp": "2024-12-31T05:45:07.541219", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 364, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-31T05:46:12.096245", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T05:54:41.482499", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T05:56:47.195508", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T05:57:09.346949", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T05:57:55.036223", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T05:57:55.932228", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 203, "message": "Failed to create school: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $6: Url('http://sakagirlssecondaryschool.com... (expected str, got Url)\n[SQL: INSERT INTO schools (name, email, phone, registration_number, school_type, website, status, address, county, postal_code, class_system, class_range, extra_info, is_active, created_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::JSON, $13::JSON, $14::BOOLEAN, $15::TIMESTAMP WITH TIME ZONE) RETURNING schools.id, schools.updated_at]\n[parameters: ('Saka Girls Secondary School', 'sakagirlssecschol@gmail.com', '+254723456789', 'SCH-2024-007', <SchoolType.SECONDARY: 'secondary'>, Url('http://sakagirlssecondaryschool.com/'), <SchoolStatus.ACTIVE: 'active'>, '123 Saka Road, Northern County', 'Northern County', '00100', 'Standard 8-4-4', '{\"start\": 1, \"end\": 4}', '{\"motto\": \"Education for a brighter future\", \"established\": \"2005\"}', True, datetime.datetime(2024, 12, 31, 5, 57, 55, 313933))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"timestamp": "2024-12-31T05:57:55.934198", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $6: Url('http://sakagirlssecondaryschool.com... (expected str, got Url)\n[SQL: INSERT INTO schools (name, email, phone, registration_number, school_type, website, status, address, county, postal_code, class_system, class_range, extra_info, is_active, created_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::JSON, $13::JSON, $14::BOOLEAN, $15::TIMESTAMP WITH TIME ZONE) RETURNING schools.id, schools.updated_at]\n[parameters: ('Saka Girls Secondary School', 'sakagirlssecschol@gmail.com', '+254723456789', 'SCH-2024-007', <SchoolType.SECONDARY: 'secondary'>, Url('http://sakagirlssecondaryschool.com/'), <SchoolStatus.ACTIVE: 'active'>, '123 Saka Road, Northern County', 'Northern County', '00100', 'Standard 8-4-4', '{\"start\": 1, \"end\": 4}', '{\"motto\": \"Education for a brighter future\", \"established\": \"2005\"}', True, datetime.datetime(2024, 12, 31, 5, 57, 55, 313933))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"timestamp": "2024-12-31T06:08:38.267237", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T06:08:38.836881", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 203, "message": "Failed to create school: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $6: Url('http://sakagirlssecondaryschool.com... (expected str, got Url)\n[SQL: INSERT INTO schools (name, email, phone, registration_number, school_type, website, status, address, county, postal_code, class_system, class_range, extra_info, is_active, created_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::JSON, $13::JSON, $14::BOOLEAN, $15::TIMESTAMP WITH TIME ZONE) RETURNING schools.id, schools.updated_at]\n[parameters: ('Saka Girls Secondary School', 'sakagirlssecschol@gmail.com', '+254723456789', 'SCH-2024-007', <SchoolType.SECONDARY: 'secondary'>, Url('http://sakagirlssecondaryschool.com/'), <SchoolStatus.ACTIVE: 'active'>, '123 Saka Road, Northern County', 'Northern County', '00100', 'Standard 8-4-4', '{\"start\": 1, \"end\": 4}', '{\"motto\": \"Education for a brighter future\", \"established\": \"2005\"}', True, datetime.datetime(2024, 12, 31, 6, 8, 38, 526915))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"timestamp": "2024-12-31T06:08:38.837653", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $6: Url('http://sakagirlssecondaryschool.com... (expected str, got Url)\n[SQL: INSERT INTO schools (name, email, phone, registration_number, school_type, website, status, address, county, postal_code, class_system, class_range, extra_info, is_active, created_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::JSON, $13::JSON, $14::BOOLEAN, $15::TIMESTAMP WITH TIME ZONE) RETURNING schools.id, schools.updated_at]\n[parameters: ('Saka Girls Secondary School', 'sakagirlssecschol@gmail.com', '+254723456789', 'SCH-2024-007', <SchoolType.SECONDARY: 'secondary'>, Url('http://sakagirlssecondaryschool.com/'), <SchoolStatus.ACTIVE: 'active'>, '123 Saka Road, Northern County', 'Northern County', '00100', 'Standard 8-4-4', '{\"start\": 1, \"end\": 4}', '{\"motto\": \"Education for a brighter future\", \"established\": \"2005\"}', True, datetime.datetime(2024, 12, 31, 6, 8, 38, 526915))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"timestamp": "2024-12-31T06:11:41.257515", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T06:14:45.204862", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 191, "message": "Failed to send welcome email to school: Saka Girls Secondary School"}
{"timestamp": "2024-12-31T06:14:45.205601", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 193, "message": "Created new school: Saka Girls Secondary School with registration number: SCH-2024-007"}
{"timestamp": "2024-12-31T06:21:18.886651", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 324, "message": "Authentication attempt for non-existent user: abdullahiwardere@yahoo.com"}
{"timestamp": "2024-12-31T06:24:04.254745", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 331, "message": "Failed authentication attempt for user: safwaismail8@gmail.com"}
{"timestamp": "2024-12-31T11:14:52.771501", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 364, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-31T13:36:50.575288", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: 'RateLimiter' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T13:38:23.099066", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: 'RateLimiter' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T13:39:14.015592", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: 'RateLimiter' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T13:39:14.017744", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T13:42:04.126864", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: 'RateLimiter' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T13:42:04.129460", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T13:46:32.184950", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: RateLimiter.check_rate_limit() got an unexpected keyword argument 'max_requests'"}
{"timestamp": "2024-12-31T13:46:32.187742", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T13:51:11.086905", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_account_lockout", "line": 136, "message": "Error checking account lockout: type object 'FailedLoginAttempt' has no attribute 'email'"}
{"timestamp": "2024-12-31T13:51:12.077284", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "clear_failed_attempts", "line": 161, "message": "Error clearing failed attempts: type object 'FailedLoginAttempt' has no attribute 'email'"}
{"timestamp": "2024-12-31T13:51:12.152523", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T13:51:12.167702", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T14:27:15.399394", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T14:27:15.403124", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T16:28:10.569982", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T16:28:10.602985", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T17:22:35.997003", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "transaction", "line": 45, "message": "Transaction error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T17:22:36.019577", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 432, "message": "Database error during authentication: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T17:22:36.023164", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T17:25:39.050474", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 438, "message": "Authentication error: 'coroutine' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T17:25:39.055622", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T17:41:03.925475", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 441, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T17:41:03.936561", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T17:44:09.041010", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 443, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T17:44:09.043687", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T18:37:00.922865", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 406, "message": "Authentication error: 'NoneType' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T18:37:00.928397", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T18:45:47.164507", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 230, "message": "Unexpected error during login: name 'EmailStr' is not defined", "exception": {"type": "NameError", "message": "name 'EmailStr' is not defined", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 166, in login\n    if not isinstance(credentials.email, EmailStr):\n                                         ^^^^^^^^\n", "NameError: name 'EmailStr' is not defined\n"]}}
{"timestamp": "2024-12-31T18:48:27.589796", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 444, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T18:48:27.592340", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: Authentication failed", "exception": {"type": "HTTPException", "message": "500: Authentication failed", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 368, in authenticate_user\n    if not await self.rate_limiter.check_rate_limit(request, \"login\", max_requests=5):\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limiter'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 445, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: Authentication failed\n"]}}
{"timestamp": "2024-12-31T18:54:34.271772", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: name 'ValidationError' is not defined", "exception": {"type": "NameError", "message": "name 'ValidationError' is not defined", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 372, in authenticate_user\n    if not is_valid_email(email):\n           ^^^^^^^^^^^^^^\n", "NameError: name 'is_valid_email' is not defined\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 482, in authenticate_user\n    except ValidationError as e:\n           ^^^^^^^^^^^^^^^\n", "NameError: name 'ValidationError' is not defined\n"]}}
{"timestamp": "2024-12-31T19:05:49.083290", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 444, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T19:05:49.091331", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: Authentication failed", "exception": {"type": "HTTPException", "message": "500: Authentication failed", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 368, in authenticate_user\n    if not await self.rate_limiter.check_rate_limit(request, \"login\", max_requests=5):\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limiter'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 445, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: Authentication failed\n"]}}
{"timestamp": "2024-12-31T19:22:53.960130", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: name 'AccountLockedException' is not defined", "exception": {"type": "NameError", "message": "name 'AccountLockedException' is not defined", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 388, in authenticate_user\n    if not await self.rate_limiter.check_rate_limit(request, \"login\", max_requests=5):\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limiter'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 455, in authenticate_user\n    except AccountLockedException:\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "NameError: name 'AccountLockedException' is not defined\n"]}}
{"timestamp": "2024-12-31T19:23:32.638857", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 468, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T19:23:32.639836", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: Authentication failed", "exception": {"type": "HTTPException", "message": "500: Authentication failed", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 388, in authenticate_user\n    if not await self.rate_limiter.check_rate_limit(request, \"login\", max_requests=5):\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limiter'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 469, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: Authentication failed\n"]}}
{"timestamp": "2024-12-31T19:27:47.687474", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 468, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T19:27:47.704021", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: Authentication failed", "exception": {"type": "HTTPException", "message": "500: Authentication failed", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 388, in authenticate_user\n    if not await self.rate_limiter.check_rate_limit(request, \"login\", max_requests=5):\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limiter'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 469, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: Authentication failed\n"]}}
{"timestamp": "2024-12-31T19:33:27.877470", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "initialize", "line": 75, "message": "Failed to initialize AuthService: Missing required JWT settings: SECRET_KEY, ALGORITHM, ACCESS_TOKEN_EXPIRE_MINUTES, REFRESH_TOKEN_EXPIRE_DAYS, FAILED_ATTEMPTS, DURATION_MINUTES, RATE_LIMIT_MAX_REQUESTS, RATE_LIMIT_TIME_WINDOW"}
{"timestamp": "2024-12-31T19:33:27.885216", "level": "CRITICAL", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 217, "message": "Configuration error during login: Failed to initialize authentication service"}
{"timestamp": "2024-12-31T19:45:08.225154", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "transaction", "line": 57, "message": "Transaction error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T19:45:08.232304", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 396, "message": "Database error during authentication: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T19:45:08.233100", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: Authentication failed", "exception": {"type": "HTTPException", "message": "500: Authentication failed", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 363, in authenticate_user\n    sub=str(user.id),\n            ^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 566, in __get__\n    return self.impl.get(state, dict_)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1086, in get\n    value = self._fire_loader_callables(state, key, passive)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1116, in _fire_loader_callables\n    return state._load_expired(state, passive)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py\", line 803, in _load_expired\n    self.manager.expired_attribute_loader(self, toload, passive)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 1670, in load_scalar_attributes\n    result = load_on_ident(\n             ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 509, in load_on_ident\n    return load_on_pk_identity(\n           ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 694, in load_on_pk_identity\n    session.execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2362, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2247, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py\", line 305, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2358, in _handle_dbapi_exception\n    raise exc_info[1].with_traceback(exc_info[2])\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 572, in execute\n    self._adapt_connection.await_(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 123, in await_only\n    raise exc.MissingGreenlet(\n", "sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 397, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: Authentication failed\n"]}}
{"timestamp": "2025-01-01T04:57:43.054973", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 410, "message": "Unexpected authentication error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2025-01-01T04:57:43.069345", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: name 'SQLAlchemyError' is not defined", "exception": {"type": "NameError", "message": "name 'SQLAlchemyError' is not defined", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 379, in authenticate_user\n    sub=str(user.id),\n            ^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 566, in __get__\n    return self.impl.get(state, dict_)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1086, in get\n    value = self._fire_loader_callables(state, key, passive)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1116, in _fire_loader_callables\n    return state._load_expired(state, passive)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py\", line 803, in _load_expired\n    self.manager.expired_attribute_loader(self, toload, passive)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 1670, in load_scalar_attributes\n    result = load_on_ident(\n             ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 509, in load_on_ident\n    return load_on_pk_identity(\n           ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 694, in load_on_pk_identity\n    session.execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2362, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2247, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py\", line 305, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2358, in _handle_dbapi_exception\n    raise exc_info[1].with_traceback(exc_info[2])\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 572, in execute\n    self._adapt_connection.await_(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 123, in await_only\n    raise exc.MissingGreenlet(\n", "sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 413, in authenticate_user\n    detail=get_error_message(\"authentication_failed\", language)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/core/errors.py\", line 192, in get_error_message\n    elif isinstance(error, SQLAlchemyError):\n                           ^^^^^^^^^^^^^^^\n", "NameError: name 'SQLAlchemyError' is not defined\n"]}}
{"timestamp": "2025-01-01T05:00:18.928693", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 410, "message": "Unexpected authentication error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2025-01-01T05:00:18.933124", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'authentication_failed', 'status_code': 500}", "exception": {"type": "HTTPException", "message": "500: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'authentication_failed', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 379, in authenticate_user\n    sub=str(user.id),\n            ^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 566, in __get__\n    return self.impl.get(state, dict_)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1086, in get\n    value = self._fire_loader_callables(state, key, passive)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1116, in _fire_loader_callables\n    return state._load_expired(state, passive)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py\", line 803, in _load_expired\n    self.manager.expired_attribute_loader(self, toload, passive)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 1670, in load_scalar_attributes\n    result = load_on_ident(\n             ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 509, in load_on_ident\n    return load_on_pk_identity(\n           ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 694, in load_on_pk_identity\n    session.execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2362, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2247, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py\", line 305, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2358, in _handle_dbapi_exception\n    raise exc_info[1].with_traceback(exc_info[2])\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 572, in execute\n    self._adapt_connection.await_(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 123, in await_only\n    raise exc.MissingGreenlet(\n", "sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 411, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'authentication_failed', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-01T05:11:12.005013", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 397, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T05:51:37.510878", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 427, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T05:53:47.224484", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 427, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T06:09:14.050663", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 302, "message": "Token creation value error: Token must include user identifier (sub)"}
{"timestamp": "2025-01-01T06:09:14.055482", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 487, "message": "Authentication failed for mikailismail260@gmail.com: Token must include user identifier (sub)"}
{"timestamp": "2025-01-01T06:48:34.286265", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 465, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T06:48:34.291308", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 305, "message": "Error creating access token: Logger._log() got an unexpected keyword argument 'type'"}
{"timestamp": "2025-01-01T06:48:34.292740", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 489, "message": "Authentication failed for mikailismail260@gmail.com: Could not create access token"}
{"timestamp": "2025-01-01T06:52:42.332306", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 472, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T06:52:42.339884", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 294, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T06:52:42.406845", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 294, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T06:52:42.407875", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 486, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T06:54:41.483226", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 366, "message": "Unexpected token verification error: Logger._log() got an unexpected keyword argument 'type'"}
{"timestamp": "2025-01-01T06:58:00.546627", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T06:58:00.799940", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T06:58:42.616812", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T06:58:42.652761", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T07:03:09.693490", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T07:03:09.795740", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T07:05:27.859498", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T07:05:28.038480", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T07:09:12.354299", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T07:09:12.444538", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 218, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T07:09:12.448254", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: name 'HTTPException' is not defined"}
{"timestamp": "2025-01-01T08:05:07.873710", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 354, "message": "Token expired"}
{"timestamp": "2025-01-01T08:06:00.880344", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 474, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T08:06:00.880874", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 294, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:06:00.881806", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 294, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:06:00.882578", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 488, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T08:06:45.006400", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T08:06:45.320956", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 219, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T08:06:45.323252", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: name 'status' is not defined"}
{"timestamp": "2025-01-01T08:08:56.875138", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T08:12:00.838529", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 189, "message": "Failed to send welcome email to school: Hafsa Junior Academy"}
{"timestamp": "2025-01-01T08:12:00.842869", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 191, "message": "Created new school: Hafsa Junior Academy with registration number: SCH-2025-001"}
{"timestamp": "2025-01-01T08:24:59.963357", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 238, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (1, null, 2025-01-01 00:24:59.892518-08, 127.0.0.1, null, hafswirakullow@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('hafswirakullow@gmail.com', datetime.datetime(2025, 1, 1, 8, 24, 59, 892518, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:24:59.976601", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 498, "message": "Authentication failed for hafswirakullow@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:27:05.485025", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 238, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (2, null, 2025-01-01 00:27:05.445989-08, 127.0.0.1, null, hafswirakullow@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('hafswirakullow@gmail.com', datetime.datetime(2025, 1, 1, 8, 27, 5, 445989, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:27:05.493227", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 498, "message": "Authentication failed for hafswirakullow@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:35:41.847420", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (3, null, 2025-01-01 00:35:41.797731-08, 127.0.0.1, null, hafswirakullow@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('hafswirakullow@gmail.com', datetime.datetime(2025, 1, 1, 8, 35, 41, 797731, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:35:41.857543", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 546, "message": "Authentication failed for hafswirakullow@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:36:09.114763", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 522, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T08:36:09.116996", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 342, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:36:09.271646", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 342, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:36:09.274254", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 536, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T08:37:30.909094", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 532, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T08:37:30.913119", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 342, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:37:30.931316", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 342, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:37:30.932222", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 546, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T08:38:34.744681", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (4, null, 2025-01-01 00:38:34.64874-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 34, 648740, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:34.749890", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:40.176481", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (5, null, 2025-01-01 00:38:40.172827-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 40, 172827, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:40.179821", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:42.446874", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (6, null, 2025-01-01 00:38:42.433446-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 42, 433446, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:42.450111", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:44.348765", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (7, null, 2025-01-01 00:38:44.346156-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 44, 346156, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:44.349359", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:46.286052", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (8, null, 2025-01-01 00:38:46.27594-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 46, 275940, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:46.288061", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:48.394729", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (9, null, 2025-01-01 00:38:48.390929-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 48, 390929, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:48.398120", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:50.797439", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (10, null, 2025-01-01 00:38:50.791173-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 50, 791173, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:50.804573", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:53.239327", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (11, null, 2025-01-01 00:38:53.231582-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 53, 231582, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:53.241594", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:55.386302", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (12, null, 2025-01-01 00:38:55.383954-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 55, 383954, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:55.387870", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T17:12:07.696670", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 88, "message": "Auth event"}
{"timestamp": "2025-01-01T17:12:52.483439", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 532, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T17:12:52.484342", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 342, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T17:12:52.485267", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 342, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T17:12:52.489301", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 546, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T17:15:41.629502", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 89, "message": "Auth event", "user_id": "1"}
{"timestamp": "2025-01-01T17:15:41.640893", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 87, "message": "Auth event"}
{"timestamp": "2025-01-01T17:17:52.437356", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 89, "message": "Auth event", "user_id": "1"}
{"timestamp": "2025-01-01T17:17:52.437969", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 87, "message": "Auth event"}
{"timestamp": "2025-01-01T17:18:03.729068", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 533, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T17:18:03.729687", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 343, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T17:18:03.730276", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 343, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T17:18:03.730845", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 547, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T17:18:51.179387", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 89, "message": "Auth event", "user_id": "1"}
{"timestamp": "2025-01-01T17:18:51.180900", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 87, "message": "Auth event"}
{"timestamp": "2025-01-01T17:21:07.320067", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 89, "message": "Auth event", "user_id": "1"}
{"timestamp": "2025-01-01T17:21:07.323828", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 87, "message": "Auth event"}
{"timestamp": "2025-01-01T17:29:09.852233", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 87, "message": "Auth event"}
{"timestamp": "2025-01-01T17:32:01.855059", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 578, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T17:32:01.857907", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 605, "message": "Unexpected authentication error: 'AuthService' object has no attribute 'create_token'"}
{"timestamp": "2025-01-01T17:33:56.021308", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 578, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T17:33:56.023734", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 376, "message": "Error creating access token: 'JWTSettings' object has no attribute 'TOKEN_ISSUER'", "exception": {"type": "AttributeError", "message": "'JWTSettings' object has no attribute 'TOKEN_ISSUER'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 352, in create_token\n    \"iss\": self.settings.TOKEN_ISSUER  # Add issuer claim\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/pydantic/main.py\", line 856, in __getattr__\n    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\n", "AttributeError: 'JWTSettings' object has no attribute 'TOKEN_ISSUER'\n"]}}
{"timestamp": "2025-01-01T17:33:56.062257", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 602, "message": "Authentication failed for mikailismail260@gmail.com: Could not create access token"}
{"timestamp": "2025-01-01T17:34:27.762944", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 578, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T17:34:27.770407", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 376, "message": "Error creating access token: 'JWTSettings' object has no attribute 'TOKEN_ISSUER'", "exception": {"type": "AttributeError", "message": "'JWTSettings' object has no attribute 'TOKEN_ISSUER'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 352, in create_token\n    \"iss\": self.settings.TOKEN_ISSUER  # Add issuer claim\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/pydantic/main.py\", line 856, in __getattr__\n    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\n", "AttributeError: 'JWTSettings' object has no attribute 'TOKEN_ISSUER'\n"]}}
{"timestamp": "2025-01-01T17:34:27.795836", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 602, "message": "Authentication failed for mikailismail260@gmail.com: Could not create access token"}
{"timestamp": "2025-01-01T17:36:07.815629", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 541, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T17:36:07.819873", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 324, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T17:36:07.875526", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 324, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T17:36:07.876323", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T17:50:31.532310", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 87, "message": "Auth event"}
{"timestamp": "2025-01-01T18:13:49.038510", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 541, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T18:13:49.045619", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 324, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T18:13:49.095145", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 324, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T18:13:49.095842", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T18:16:21.835570", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 87, "message": "Auth event"}
{"timestamp": "2025-01-01T18:16:58.987864", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 87, "message": "Auth event"}
{"timestamp": "2025-01-01T18:34:31.200186", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "log_auth_event", "line": 87, "message": "Auth event"}
{"timestamp": "2025-01-02T04:48:29.074053", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 364, "message": "Token expired"}
{"timestamp": "2025-01-02T04:48:53.464372", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 531, "message": "Unexpected authentication error: Can't operate on closed transaction inside context manager.  Please complete the context manager before emitting further commands."}
{"timestamp": "2025-01-02T04:52:36.811723", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 531, "message": "Unexpected authentication error: Can't operate on closed transaction inside context manager.  Please complete the context manager before emitting further commands."}
{"timestamp": "2025-01-02T05:01:16.103800", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 542, "message": "Unexpected authentication error"}
{"timestamp": "2025-01-02T05:03:49.395982", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 542, "message": "Unexpected authentication error"}
{"timestamp": "2025-01-02T05:11:10.563846", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 287, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (13, null, 2025-01-01 21:11:10.434245-08, 127.0.0.1, null, mikailismai260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismai260@gmail.com', datetime.datetime(2025, 1, 2, 5, 11, 10, 434245, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-02T05:11:10.589267", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 533, "message": "Authentication failed"}
{"timestamp": "2025-01-02T05:13:48.410183", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 287, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (14, null, 2025-01-01 21:13:48.383433-08, 127.0.0.1, null, mikailismai260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismai260@gmail.com', datetime.datetime(2025, 1, 2, 5, 13, 48, 383433, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-02T05:13:48.419509", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 533, "message": "Authentication failed"}
{"timestamp": "2025-01-02T05:14:31.272382", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 287, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (15, null, 2025-01-01 21:14:31.258822-08, 127.0.0.1, null, mikailismai260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismai260@gmail.com', datetime.datetime(2025, 1, 2, 5, 14, 31, 258822, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-02T05:14:31.274358", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 533, "message": "Authentication failed"}
{"timestamp": "2025-01-02T05:14:46.802385", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 542, "message": "Unexpected authentication error"}
{"timestamp": "2025-01-02T05:25:18.471944", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 543, "message": "Unexpected authentication error"}
{"timestamp": "2025-01-02T05:30:18.901715", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 543, "message": "Unexpected authentication error", "exception": {"type": "InvalidRequestError", "message": "Can't operate on closed transaction inside context manager.  Please complete the context manager before emitting further commands.", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 498, in authenticate_user\n    sub=str(user.id),\n            ^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 566, in __get__\n    return self.impl.get(state, dict_)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1086, in get\n    value = self._fire_loader_callables(state, key, passive)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1116, in _fire_loader_callables\n    return state._load_expired(state, passive)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py\", line 803, in _load_expired\n    self.manager.expired_attribute_loader(self, toload, passive)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 1670, in load_scalar_attributes\n    result = load_on_ident(\n             ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 509, in load_on_ident\n    return load_on_pk_identity(\n           ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 694, in load_on_pk_identity\n    session.execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2362, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2237, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2101, in _connection_for_bind\n    TransactionalContext._trans_ctx_check(self)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/util.py\", line 111, in _trans_ctx_check\n    raise exc.InvalidRequestError(\n", "sqlalchemy.exc.InvalidRequestError: Can't operate on closed transaction inside context manager.  Please complete the context manager before emitting further commands.\n"]}}
{"timestamp": "2025-01-02T05:32:39.762826", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 552, "message": "Unexpected authentication error", "exception": {"type": "InvalidRequestError", "message": "Can't operate on closed transaction inside context manager.  Please complete the context manager before emitting further commands.", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 508, in authenticate_user\n    user_id=user.id  # This should be safe as it's already loaded\n            ^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 566, in __get__\n    return self.impl.get(state, dict_)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1086, in get\n    value = self._fire_loader_callables(state, key, passive)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1116, in _fire_loader_callables\n    return state._load_expired(state, passive)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py\", line 803, in _load_expired\n    self.manager.expired_attribute_loader(self, toload, passive)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 1670, in load_scalar_attributes\n    result = load_on_ident(\n             ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 509, in load_on_ident\n    return load_on_pk_identity(\n           ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 694, in load_on_pk_identity\n    session.execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2362, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2237, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2101, in _connection_for_bind\n    TransactionalContext._trans_ctx_check(self)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/util.py\", line 111, in _trans_ctx_check\n    raise exc.InvalidRequestError(\n", "sqlalchemy.exc.InvalidRequestError: Can't operate on closed transaction inside context manager.  Please complete the context manager before emitting further commands.\n"]}}
{"timestamp": "2025-01-02T05:35:15.833702", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 316, "message": "Creating token"}
{"timestamp": "2025-01-02T05:35:15.923870", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 316, "message": "Creating token"}
{"timestamp": "2025-01-02T05:35:15.927328", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 531, "message": "Authentication successful", "user_id": "1"}
{"timestamp": "2025-01-02T23:49:07.085262", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 334, "message": "Token creation error"}
{"timestamp": "2025-01-02T23:49:07.089600", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 561, "message": "Authentication failed"}
{"timestamp": "2025-01-02T23:53:11.954579", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 334, "message": "Token creation error"}
{"timestamp": "2025-01-02T23:53:11.955544", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 561, "message": "Authentication failed"}
{"timestamp": "2025-01-02T23:53:35.881879", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 334, "message": "Token creation error"}
{"timestamp": "2025-01-02T23:53:35.882734", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 561, "message": "Authentication failed"}
{"timestamp": "2025-01-02T23:58:44.055002", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 343, "message": "Token creation failed", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_session_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 311, in create_token\n    session_id = await self._create_session(str(data.get(\"sub\")), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 742, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'\n"]}, "user_id": "1"}
{"timestamp": "2025-01-02T23:58:44.091234", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 583, "message": "Authentication failed"}
{"timestamp": "2025-01-03T00:00:22.435652", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 343, "message": "Token creation failed", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_session_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 311, in create_token\n    session_id = await self._create_session(str(data.get(\"sub\")), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 742, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'\n"]}, "user_id": "1"}
{"timestamp": "2025-01-03T00:00:22.457950", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 583, "message": "Authentication failed"}
{"timestamp": "2025-01-03T00:07:36.029809", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "_create_session", "line": 786, "message": "Session creation failed", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_session_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 762, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'\n"]}, "user_id": "1"}
{"timestamp": "2025-01-03T00:07:36.046516", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 321, "message": "Session creation failed", "exception": {"type": "AuthenticationError", "message": "Failed to create session", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 762, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 318, in create_token\n    session_id = await self._create_session(str(data['sub']), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 794, in _create_session\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n"]}}
{"timestamp": "2025-01-03T00:07:36.063874", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 602, "message": "Authentication failed"}
{"timestamp": "2025-01-03T00:16:17.420076", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 601, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_check_rate_limit'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 525, in authenticate_user\n    await self._check_rate_limit(email, client_ip)\n          ^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_check_rate_limit'. Did you mean: 'check_rate_limit'?\n"]}}
{"timestamp": "2025-01-03T00:18:15.776660", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 601, "message": "Unexpected login error", "exception": {"type": "TypeError", "message": "AuthService.check_rate_limit() takes 2 positional arguments but 3 were given", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 525, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: AuthService.check_rate_limit() takes 2 positional arguments but 3 were given\n"]}}
{"timestamp": "2025-01-03T00:22:20.066121", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 592, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_rate_limit_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 516, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 153, in check_rate_limit\n    async with self._rate_limit_lock:\n               ^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_rate_limit_lock'. Did you mean: '_rate_limit_cache'?\n"]}}
{"timestamp": "2025-01-03T00:23:42.630951", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 592, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_rate_limit_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 516, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 153, in check_rate_limit\n    async with self._rate_limit_lock:\n               ^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_rate_limit_lock'. Did you mean: '_rate_limit_cache'?\n"]}}
{"timestamp": "2025-01-03T00:24:10.436133", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 592, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute 'rate_limit_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 516, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 153, in check_rate_limit\n    async with self.rate_limit_lock:\n               ^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limit_lock'. Did you mean: '_rate_limit_cache'?\n"]}}
{"timestamp": "2025-01-03T00:28:23.825873", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 592, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute 'check_rate_limit_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 516, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 153, in check_rate_limit\n    async with self.check_rate_limit_lock:\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'check_rate_limit_lock'. Did you mean: 'check_rate_limit'?\n"]}}
{"timestamp": "2025-01-03T00:30:43.907119", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 618, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute 'rate_limit_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 542, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 153, in check_rate_limit\n    async with self.rate_limit_lock:  # Using consistent name here\n               ^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limit_lock'. Did you mean: 'rate_limit_cache'?\n"]}}
{"timestamp": "2025-01-03T00:32:20.264544", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 626, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute 'max_login_attempts'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 550, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 165, in check_rate_limit\n    if attempts[\"count\"] >= self.max_login_attempts:\n                            ^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'max_login_attempts'. Did you mean: 'login_attempts'?\n"]}}
{"timestamp": "2025-01-03T00:57:46.112657", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 646, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute 'user_service'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 573, in authenticate_user\n    user = await self.user_service.get_user_by_email(email)\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'user_service'\n"]}}
{"timestamp": "2025-01-03T00:57:46.134568", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 573, in authenticate_user\n    user = await self.user_service.get_user_by_email(email)\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'user_service'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 654, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:01:49.147809", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 646, "message": "Unexpected login error", "exception": {"type": "TypeError", "message": "object bool can't be used in 'await' expression", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 579, in authenticate_user\n    if not await self.verify_password(password, user.password_hash):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: object bool can't be used in 'await' expression\n"]}}
{"timestamp": "2025-01-03T01:01:49.154395", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 579, in authenticate_user\n    if not await self.verify_password(password, user.password_hash):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: object bool can't be used in 'await' expression\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 654, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:05:37.338531", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 642, "message": "Unexpected login error", "exception": {"type": "TypeError", "message": "AuthService.check_rate_limit() missing 1 required positional argument: 'ip'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 570, in authenticate_user\n    await self.check_rate_limit(request)  # Using original rate limit method\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: AuthService.check_rate_limit() missing 1 required positional argument: 'ip'\n"]}}
{"timestamp": "2025-01-03T01:05:37.341475", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 570, in authenticate_user\n    await self.check_rate_limit(request)  # Using original rate limit method\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: AuthService.check_rate_limit() missing 1 required positional argument: 'ip'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 650, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:10:28.966319", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 642, "message": "Unexpected login error", "exception": {"type": "TypeError", "message": "AuthService.clear_failed_attempts() missing 1 required positional argument: 'ip'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 588, in authenticate_user\n    await self.clear_failed_attempts(email)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: AuthService.clear_failed_attempts() missing 1 required positional argument: 'ip'\n"]}}
{"timestamp": "2025-01-03T01:10:28.971472", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 588, in authenticate_user\n    await self.clear_failed_attempts(email)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: AuthService.clear_failed_attempts() missing 1 required positional argument: 'ip'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 650, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:14:51.546912", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "_create_session", "line": 813, "message": "Session creation failed", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_session_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 789, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'. Did you mean: 'session_lock'?\n"]}, "user_id": "1"}
{"timestamp": "2025-01-03T01:14:51.603793", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 367, "message": "Session creation failed", "exception": {"type": "AuthenticationError", "message": "Failed to create session", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 789, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'. Did you mean: 'session_lock'?\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 364, in create_token\n    session_id = await self._create_session(str(data['sub']), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 821, in _create_session\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n"]}}
{"timestamp": "2025-01-03T01:14:51.673196", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 642, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "Failed to create session", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 789, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'. Did you mean: 'session_lock'?\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 364, in create_token\n    session_id = await self._create_session(str(data['sub']), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 821, in _create_session\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 604, in authenticate_user\n    access_token = await self.create_token(token_data, \"access\")\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 368, in create_token\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n"]}}
{"timestamp": "2025-01-03T01:14:51.700708", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 789, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'. Did you mean: 'session_lock'?\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 364, in create_token\n    session_id = await self._create_session(str(data['sub']), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 821, in _create_session\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 604, in authenticate_user\n    access_token = await self.create_token(token_data, \"access\")\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 368, in create_token\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 650, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:21:57.286307", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "_create_session", "line": 802, "message": "Session created", "user_id": "1"}
{"timestamp": "2025-01-03T01:21:57.359936", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 389, "message": "Token created successfully", "user_id": "1"}
{"timestamp": "2025-01-03T01:21:57.360891", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 389, "message": "Token created successfully", "user_id": "1"}
{"timestamp": "2025-01-03T01:21:57.361561", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 616, "message": "Successful login", "user_id": "1"}
{"timestamp": "2025-01-03T01:21:57.372478", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 642, "message": "Unexpected login error", "exception": {"type": "ValidationError", "message": "1 validation error for LoginResponse\nuser\n  Input should be a valid dictionary [type=dict_type, input_value=UserResponse(id=1, email=...in', role='super_admin'), input_type=UserResponse]\n    For further information visit https://errors.pydantic.dev/2.9/v/dict_type", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 625, in authenticate_user\n    return LoginResponse(\n           ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/pydantic/main.py\", line 212, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "pydantic_core._pydantic_core.ValidationError: 1 validation error for LoginResponse\nuser\n  Input should be a valid dictionary [type=dict_type, input_value=UserResponse(id=1, email=...in', role='super_admin'), input_type=UserResponse]\n    For further information visit https://errors.pydantic.dev/2.9/v/dict_type\n"]}}
{"timestamp": "2025-01-03T01:21:57.391061", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 625, in authenticate_user\n    return LoginResponse(\n           ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/pydantic/main.py\", line 212, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "pydantic_core._pydantic_core.ValidationError: 1 validation error for LoginResponse\nuser\n  Input should be a valid dictionary [type=dict_type, input_value=UserResponse(id=1, email=...in', role='super_admin'), input_type=UserResponse]\n    For further information visit https://errors.pydantic.dev/2.9/v/dict_type\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 650, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:27:21.491731", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "_create_session", "line": 802, "message": "Session created", "user_id": "1"}
{"timestamp": "2025-01-03T01:27:21.529010", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 389, "message": "Token created successfully", "user_id": "1"}
{"timestamp": "2025-01-03T01:27:21.530196", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 389, "message": "Token created successfully", "user_id": "1"}
{"timestamp": "2025-01-03T01:27:21.531146", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 616, "message": "Successful login", "user_id": "1"}
{"timestamp": "2025-01-03T01:28:40.967084", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 260, "message": "Token validation error"}
{"timestamp": "2025-01-03T01:34:11.193752", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 299, "message": "Token validation error"}
{"timestamp": "2025-01-03T01:37:11.595911", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 302, "message": "Token validation error"}
{"timestamp": "2025-01-03T01:58:29.896317", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 302, "message": "Token validation error: 'AuthService' object has no attribute 'get_token_from_request'"}
{"timestamp": "2025-01-03T02:08:57.711943", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 810, "message": "Unexpected error during token validation: module 'jose.jwt' has no attribute 'InvalidTokenError'"}
{"timestamp": "2025-01-03T02:08:57.719425", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "refresh_access_token", "line": 752, "message": "Unexpected error during token refresh: 'AuthService' object has no attribute 'is_token_revoked'"}
{"timestamp": "2025-01-03T02:08:57.720004", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 302, "message": "Token validation error: 500: {'message': {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'token_refresh_failed', 'status_code': 500}, 'error_code': 'INTERNAL_SERVER_ERROR'}"}
{"timestamp": "2025-01-03T02:19:10.139785", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 810, "message": "Unexpected error during token validation: module 'jose.jwt' has no attribute 'InvalidTokenError'"}
{"timestamp": "2025-01-03T02:19:10.316413", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "refresh_access_token", "line": 752, "message": "Unexpected error during token refresh: module 'jose.jwt' has no attribute 'InvalidTokenError'"}
{"timestamp": "2025-01-03T02:19:10.317657", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 302, "message": "Token validation error: 500: {'message': {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'token_refresh_failed', 'status_code': 500}, 'error_code': 'INTERNAL_SERVER_ERROR'}"}
{"timestamp": "2025-01-03T02:23:29.013855", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 475, "message": "Invalid token: Signature verification failed."}
{"timestamp": "2025-01-03T02:23:29.019360", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 810, "message": "Unexpected error during token validation: 401: Invalid token"}
{"timestamp": "2025-01-03T02:23:29.091054", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 482, "message": "Token verification failed", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_token_blacklist'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jws.py\", line 262, in _verify_signature\n    raise JWSSignatureError()\n", "jose.exceptions.JWSSignatureError\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 142, in decode\n    payload = jws.verify(token, key, algorithms, verify=verify_signature)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jws.py\", line 73, in verify\n    _verify_signature(signing_input, header, signature, key, algorithms)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jws.py\", line 264, in _verify_signature\n    raise JWSError(\"Signature verification failed.\")\n", "jose.exceptions.JWSError: Signature verification failed.\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 429, in verify_token\n    payload = jwt.decode(\n              ^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 144, in decode\n    raise JWTError(e)\n", "jose.exceptions.JWTError: Signature verification failed.\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 798, in validate_token\n    payload = await self.verify_token(token)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 476, in verify_token\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 401: Invalid token\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 265, in validate_token\n    payload = await auth_service.validate_token(access_token, language)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 811, in validate_token\n    raise AuthenticationError(\"Token validation failed\")\n", "app.core.errors.AuthenticationError: Token validation failed\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 453, in verify_token\n    if token in self._token_blacklist:\n                ^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_token_blacklist'. Did you mean: 'token_blacklist'?\n"]}}
{"timestamp": "2025-01-03T02:23:29.137493", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "refresh_access_token", "line": 752, "message": "Unexpected error during token refresh: 401: Could not validate credentials"}
{"timestamp": "2025-01-03T02:23:29.138051", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 302, "message": "Token validation error: 500: {'message': {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'token_refresh_failed', 'status_code': 500}, 'error_code': 'INTERNAL_SERVER_ERROR'}"}
{"timestamp": "2025-01-03T02:25:28.973700", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 475, "message": "Invalid token: Signature verification failed."}
{"timestamp": "2025-01-03T02:25:28.981405", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 477, "message": "Token signature verification failed - possible invalid secret key or tampered token"}
{"timestamp": "2025-01-03T02:25:28.982101", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 811, "message": "Unexpected error during token validation: 401: Invalid token"}
{"timestamp": "2025-01-03T02:25:29.083200", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 456, "message": "Token verified successfully", "user_id": "1"}
{"timestamp": "2025-01-03T02:25:29.092344", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "_create_session", "line": 830, "message": "Session created", "user_id": "1"}
{"timestamp": "2025-01-03T02:25:29.094132", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 389, "message": "Token created successfully", "user_id": "1"}
{"timestamp": "2025-01-03T02:25:29.096222", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "refresh_access_token", "line": 733, "message": "Access token refreshed successfully", "user_id": "1"}
{"timestamp": "2025-01-03T02:27:38.183270", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 556, "message": "Token revocation check error: Not enough segments"}
{"timestamp": "2025-01-03T02:27:38.184966", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "refresh_access_token", "line": 742, "message": "Token refresh failed: Refresh token has been revoked"}
{"timestamp": "2025-01-03T02:27:38.186409", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "refresh_token", "line": 225, "message": "Token refresh error"}
