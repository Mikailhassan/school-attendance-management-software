{"timestamp": "2025-01-02T23:49:07.085262", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 334, "message": "Token creation error"}
{"timestamp": "2025-01-02T23:49:07.089600", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 561, "message": "Authentication failed"}
{"timestamp": "2025-01-02T23:53:11.954579", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 334, "message": "Token creation error"}
{"timestamp": "2025-01-02T23:53:11.955544", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 561, "message": "Authentication failed"}
{"timestamp": "2025-01-02T23:53:35.881879", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 334, "message": "Token creation error"}
{"timestamp": "2025-01-02T23:53:35.882734", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 561, "message": "Authentication failed"}
{"timestamp": "2025-01-02T23:58:44.055002", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 343, "message": "Token creation failed", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_session_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 311, in create_token\n    session_id = await self._create_session(str(data.get(\"sub\")), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 742, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'\n"]}, "user_id": "1"}
{"timestamp": "2025-01-02T23:58:44.091234", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 583, "message": "Authentication failed"}
{"timestamp": "2025-01-03T00:00:22.435652", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 343, "message": "Token creation failed", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_session_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 311, in create_token\n    session_id = await self._create_session(str(data.get(\"sub\")), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 742, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'\n"]}, "user_id": "1"}
{"timestamp": "2025-01-03T00:00:22.457950", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 583, "message": "Authentication failed"}
{"timestamp": "2025-01-03T00:07:36.029809", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "_create_session", "line": 786, "message": "Session creation failed", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_session_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 762, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'\n"]}, "user_id": "1"}
{"timestamp": "2025-01-03T00:07:36.046516", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 321, "message": "Session creation failed", "exception": {"type": "AuthenticationError", "message": "Failed to create session", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 762, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 318, in create_token\n    session_id = await self._create_session(str(data['sub']), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 794, in _create_session\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n"]}}
{"timestamp": "2025-01-03T00:07:36.063874", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 602, "message": "Authentication failed"}
{"timestamp": "2025-01-03T00:16:17.420076", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 601, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_check_rate_limit'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 525, in authenticate_user\n    await self._check_rate_limit(email, client_ip)\n          ^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_check_rate_limit'. Did you mean: 'check_rate_limit'?\n"]}}
{"timestamp": "2025-01-03T00:18:15.776660", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 601, "message": "Unexpected login error", "exception": {"type": "TypeError", "message": "AuthService.check_rate_limit() takes 2 positional arguments but 3 were given", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 525, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: AuthService.check_rate_limit() takes 2 positional arguments but 3 were given\n"]}}
{"timestamp": "2025-01-03T00:22:20.066121", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 592, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_rate_limit_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 516, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 153, in check_rate_limit\n    async with self._rate_limit_lock:\n               ^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_rate_limit_lock'. Did you mean: '_rate_limit_cache'?\n"]}}
{"timestamp": "2025-01-03T00:23:42.630951", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 592, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_rate_limit_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 516, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 153, in check_rate_limit\n    async with self._rate_limit_lock:\n               ^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_rate_limit_lock'. Did you mean: '_rate_limit_cache'?\n"]}}
{"timestamp": "2025-01-03T00:24:10.436133", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 592, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute 'rate_limit_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 516, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 153, in check_rate_limit\n    async with self.rate_limit_lock:\n               ^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limit_lock'. Did you mean: '_rate_limit_cache'?\n"]}}
{"timestamp": "2025-01-03T00:28:23.825873", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 592, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute 'check_rate_limit_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 516, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 153, in check_rate_limit\n    async with self.check_rate_limit_lock:\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'check_rate_limit_lock'. Did you mean: 'check_rate_limit'?\n"]}}
{"timestamp": "2025-01-03T00:30:43.907119", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 618, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute 'rate_limit_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 542, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 153, in check_rate_limit\n    async with self.rate_limit_lock:  # Using consistent name here\n               ^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limit_lock'. Did you mean: 'rate_limit_cache'?\n"]}}
{"timestamp": "2025-01-03T00:32:20.264544", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 626, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute 'max_login_attempts'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 550, in authenticate_user\n    await self.check_rate_limit(email, client_ip)\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 165, in check_rate_limit\n    if attempts[\"count\"] >= self.max_login_attempts:\n                            ^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'max_login_attempts'. Did you mean: 'login_attempts'?\n"]}}
{"timestamp": "2025-01-03T00:57:46.112657", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 646, "message": "Unexpected login error", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute 'user_service'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 573, in authenticate_user\n    user = await self.user_service.get_user_by_email(email)\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'user_service'\n"]}}
{"timestamp": "2025-01-03T00:57:46.134568", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 573, in authenticate_user\n    user = await self.user_service.get_user_by_email(email)\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'user_service'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 654, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:01:49.147809", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 646, "message": "Unexpected login error", "exception": {"type": "TypeError", "message": "object bool can't be used in 'await' expression", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 579, in authenticate_user\n    if not await self.verify_password(password, user.password_hash):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: object bool can't be used in 'await' expression\n"]}}
{"timestamp": "2025-01-03T01:01:49.154395", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 579, in authenticate_user\n    if not await self.verify_password(password, user.password_hash):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: object bool can't be used in 'await' expression\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 654, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:05:37.338531", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 642, "message": "Unexpected login error", "exception": {"type": "TypeError", "message": "AuthService.check_rate_limit() missing 1 required positional argument: 'ip'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 570, in authenticate_user\n    await self.check_rate_limit(request)  # Using original rate limit method\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: AuthService.check_rate_limit() missing 1 required positional argument: 'ip'\n"]}}
{"timestamp": "2025-01-03T01:05:37.341475", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 570, in authenticate_user\n    await self.check_rate_limit(request)  # Using original rate limit method\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: AuthService.check_rate_limit() missing 1 required positional argument: 'ip'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 650, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:10:28.966319", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 642, "message": "Unexpected login error", "exception": {"type": "TypeError", "message": "AuthService.clear_failed_attempts() missing 1 required positional argument: 'ip'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 588, in authenticate_user\n    await self.clear_failed_attempts(email)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: AuthService.clear_failed_attempts() missing 1 required positional argument: 'ip'\n"]}}
{"timestamp": "2025-01-03T01:10:28.971472", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 588, in authenticate_user\n    await self.clear_failed_attempts(email)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "TypeError: AuthService.clear_failed_attempts() missing 1 required positional argument: 'ip'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 650, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:14:51.546912", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "_create_session", "line": 813, "message": "Session creation failed", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_session_lock'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 789, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'. Did you mean: 'session_lock'?\n"]}, "user_id": "1"}
{"timestamp": "2025-01-03T01:14:51.603793", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 367, "message": "Session creation failed", "exception": {"type": "AuthenticationError", "message": "Failed to create session", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 789, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'. Did you mean: 'session_lock'?\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 364, in create_token\n    session_id = await self._create_session(str(data['sub']), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 821, in _create_session\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n"]}}
{"timestamp": "2025-01-03T01:14:51.673196", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 642, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "Failed to create session", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 789, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'. Did you mean: 'session_lock'?\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 364, in create_token\n    session_id = await self._create_session(str(data['sub']), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 821, in _create_session\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 604, in authenticate_user\n    access_token = await self.create_token(token_data, \"access\")\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 368, in create_token\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n"]}}
{"timestamp": "2025-01-03T01:14:51.700708", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 789, in _create_session\n    async with self._session_lock:\n               ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_session_lock'. Did you mean: 'session_lock'?\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 364, in create_token\n    session_id = await self._create_session(str(data['sub']), data)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 821, in _create_session\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 604, in authenticate_user\n    access_token = await self.create_token(token_data, \"access\")\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 368, in create_token\n    raise AuthenticationError(\n", "app.core.errors.AuthenticationError: Failed to create session\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 650, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:21:57.286307", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "_create_session", "line": 802, "message": "Session created", "user_id": "1"}
{"timestamp": "2025-01-03T01:21:57.359936", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 389, "message": "Token created successfully", "user_id": "1"}
{"timestamp": "2025-01-03T01:21:57.360891", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 389, "message": "Token created successfully", "user_id": "1"}
{"timestamp": "2025-01-03T01:21:57.361561", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 616, "message": "Successful login", "user_id": "1"}
{"timestamp": "2025-01-03T01:21:57.372478", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 642, "message": "Unexpected login error", "exception": {"type": "ValidationError", "message": "1 validation error for LoginResponse\nuser\n  Input should be a valid dictionary [type=dict_type, input_value=UserResponse(id=1, email=...in', role='super_admin'), input_type=UserResponse]\n    For further information visit https://errors.pydantic.dev/2.9/v/dict_type", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 625, in authenticate_user\n    return LoginResponse(\n           ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/pydantic/main.py\", line 212, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "pydantic_core._pydantic_core.ValidationError: 1 validation error for LoginResponse\nuser\n  Input should be a valid dictionary [type=dict_type, input_value=UserResponse(id=1, email=...in', role='super_admin'), input_type=UserResponse]\n    For further information visit https://errors.pydantic.dev/2.9/v/dict_type\n"]}}
{"timestamp": "2025-01-03T01:21:57.391061", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 185, "message": "Unexpected login error", "exception": {"type": "AuthenticationError", "message": "{'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 625, in authenticate_user\n    return LoginResponse(\n           ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/pydantic/main.py\", line 212, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "pydantic_core._pydantic_core.ValidationError: 1 validation error for LoginResponse\nuser\n  Input should be a valid dictionary [type=dict_type, input_value=UserResponse(id=1, email=...in', role='super_admin'), input_type=UserResponse]\n    For further information visit https://errors.pydantic.dev/2.9/v/dict_type\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 163, in login\n    login_response = await auth_service.authenticate_user(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 650, in authenticate_user\n    raise AuthenticationError(get_error_message(\"unexpected_error\", language))\n", "app.core.errors.AuthenticationError: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'unexpected_error', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-03T01:27:21.491731", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "_create_session", "line": 802, "message": "Session created", "user_id": "1"}
{"timestamp": "2025-01-03T01:27:21.529010", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 389, "message": "Token created successfully", "user_id": "1"}
{"timestamp": "2025-01-03T01:27:21.530196", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 389, "message": "Token created successfully", "user_id": "1"}
{"timestamp": "2025-01-03T01:27:21.531146", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 616, "message": "Successful login", "user_id": "1"}
{"timestamp": "2025-01-03T01:28:40.967084", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 260, "message": "Token validation error"}
{"timestamp": "2025-01-03T01:34:11.193752", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 299, "message": "Token validation error"}
{"timestamp": "2025-01-03T01:37:11.595911", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 302, "message": "Token validation error"}
{"timestamp": "2025-01-03T01:58:29.896317", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 302, "message": "Token validation error: 'AuthService' object has no attribute 'get_token_from_request'"}
{"timestamp": "2025-01-03T02:08:57.711943", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 810, "message": "Unexpected error during token validation: module 'jose.jwt' has no attribute 'InvalidTokenError'"}
{"timestamp": "2025-01-03T02:08:57.719425", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "refresh_access_token", "line": 752, "message": "Unexpected error during token refresh: 'AuthService' object has no attribute 'is_token_revoked'"}
{"timestamp": "2025-01-03T02:08:57.720004", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 302, "message": "Token validation error: 500: {'message': {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'token_refresh_failed', 'status_code': 500}, 'error_code': 'INTERNAL_SERVER_ERROR'}"}
{"timestamp": "2025-01-03T02:19:10.139785", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 810, "message": "Unexpected error during token validation: module 'jose.jwt' has no attribute 'InvalidTokenError'"}
{"timestamp": "2025-01-03T02:19:10.316413", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "refresh_access_token", "line": 752, "message": "Unexpected error during token refresh: module 'jose.jwt' has no attribute 'InvalidTokenError'"}
{"timestamp": "2025-01-03T02:19:10.317657", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 302, "message": "Token validation error: 500: {'message': {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'token_refresh_failed', 'status_code': 500}, 'error_code': 'INTERNAL_SERVER_ERROR'}"}
{"timestamp": "2025-01-03T02:23:29.013855", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 475, "message": "Invalid token: Signature verification failed."}
{"timestamp": "2025-01-03T02:23:29.019360", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 810, "message": "Unexpected error during token validation: 401: Invalid token"}
{"timestamp": "2025-01-03T02:23:29.091054", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 482, "message": "Token verification failed", "exception": {"type": "AttributeError", "message": "'AuthService' object has no attribute '_token_blacklist'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jws.py\", line 262, in _verify_signature\n    raise JWSSignatureError()\n", "jose.exceptions.JWSSignatureError\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 142, in decode\n    payload = jws.verify(token, key, algorithms, verify=verify_signature)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jws.py\", line 73, in verify\n    _verify_signature(signing_input, header, signature, key, algorithms)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jws.py\", line 264, in _verify_signature\n    raise JWSError(\"Signature verification failed.\")\n", "jose.exceptions.JWSError: Signature verification failed.\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 429, in verify_token\n    payload = jwt.decode(\n              ^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 144, in decode\n    raise JWTError(e)\n", "jose.exceptions.JWTError: Signature verification failed.\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 798, in validate_token\n    payload = await self.verify_token(token)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 476, in verify_token\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 401: Invalid token\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 265, in validate_token\n    payload = await auth_service.validate_token(access_token, language)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 811, in validate_token\n    raise AuthenticationError(\"Token validation failed\")\n", "app.core.errors.AuthenticationError: Token validation failed\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 453, in verify_token\n    if token in self._token_blacklist:\n                ^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute '_token_blacklist'. Did you mean: 'token_blacklist'?\n"]}}
{"timestamp": "2025-01-03T02:23:29.137493", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "refresh_access_token", "line": 752, "message": "Unexpected error during token refresh: 401: Could not validate credentials"}
{"timestamp": "2025-01-03T02:23:29.138051", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 302, "message": "Token validation error: 500: {'message': {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'token_refresh_failed', 'status_code': 500}, 'error_code': 'INTERNAL_SERVER_ERROR'}"}
{"timestamp": "2025-01-03T02:25:28.973700", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 475, "message": "Invalid token: Signature verification failed."}
{"timestamp": "2025-01-03T02:25:28.981405", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 477, "message": "Token signature verification failed - possible invalid secret key or tampered token"}
{"timestamp": "2025-01-03T02:25:28.982101", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 811, "message": "Unexpected error during token validation: 401: Invalid token"}
{"timestamp": "2025-01-03T02:25:29.083200", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 456, "message": "Token verified successfully", "user_id": "1"}
{"timestamp": "2025-01-03T02:25:29.092344", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "_create_session", "line": 830, "message": "Session created", "user_id": "1"}
{"timestamp": "2025-01-03T02:25:29.094132", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 389, "message": "Token created successfully", "user_id": "1"}
{"timestamp": "2025-01-03T02:25:29.096222", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "refresh_access_token", "line": 733, "message": "Access token refreshed successfully", "user_id": "1"}
{"timestamp": "2025-01-03T02:27:38.183270", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 556, "message": "Token revocation check error: Not enough segments"}
{"timestamp": "2025-01-03T02:27:38.184966", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "refresh_access_token", "line": 742, "message": "Token refresh failed: Refresh token has been revoked"}
{"timestamp": "2025-01-03T02:27:38.186409", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "refresh_token", "line": 225, "message": "Token refresh error"}
{"timestamp": "2025-01-03T16:14:21.940990", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 292, "message": "Token validation failed: No token provided"}
{"timestamp": "2025-01-03T16:16:27.741184", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 292, "message": "Token validation failed: No token provided"}
{"timestamp": "2025-01-03T16:16:34.069530", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 292, "message": "Token validation failed: No token provided"}
{"timestamp": "2025-01-03T16:17:00.981123", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 292, "message": "Token validation failed: No token provided"}
{"timestamp": "2025-01-03T16:17:00.987309", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 292, "message": "Token validation failed: No token provided"}
{"timestamp": "2025-01-03T16:22:02.183671", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "validate_token", "line": 292, "message": "Token validation failed: No token provided"}
