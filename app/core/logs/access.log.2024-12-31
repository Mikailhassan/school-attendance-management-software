{"timestamp": "2024-12-30T21:11:13.691609", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 92, "message": "Token verification error: Signature has expired."}
{"timestamp": "2024-12-30T21:11:13.724766", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "get_current_user", "line": 237, "message": "Unexpected error in get_current_user: 401: Invalid token"}
{"timestamp": "2024-12-30T21:11:59.062403", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 190, "message": "Authentication error: name 'set_auth_cookies' is not defined"}
{"timestamp": "2024-12-31T05:45:07.541219", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 364, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-31T05:46:12.096245", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T05:54:41.482499", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T05:56:47.195508", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T05:57:09.346949", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T05:57:55.036223", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T05:57:55.932228", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 203, "message": "Failed to create school: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $6: Url('http://sakagirlssecondaryschool.com... (expected str, got Url)\n[SQL: INSERT INTO schools (name, email, phone, registration_number, school_type, website, status, address, county, postal_code, class_system, class_range, extra_info, is_active, created_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::JSON, $13::JSON, $14::BOOLEAN, $15::TIMESTAMP WITH TIME ZONE) RETURNING schools.id, schools.updated_at]\n[parameters: ('Saka Girls Secondary School', 'sakagirlssecschol@gmail.com', '+254723456789', 'SCH-2024-007', <SchoolType.SECONDARY: 'secondary'>, Url('http://sakagirlssecondaryschool.com/'), <SchoolStatus.ACTIVE: 'active'>, '123 Saka Road, Northern County', 'Northern County', '00100', 'Standard 8-4-4', '{\"start\": 1, \"end\": 4}', '{\"motto\": \"Education for a brighter future\", \"established\": \"2005\"}', True, datetime.datetime(2024, 12, 31, 5, 57, 55, 313933))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"timestamp": "2024-12-31T05:57:55.934198", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $6: Url('http://sakagirlssecondaryschool.com... (expected str, got Url)\n[SQL: INSERT INTO schools (name, email, phone, registration_number, school_type, website, status, address, county, postal_code, class_system, class_range, extra_info, is_active, created_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::JSON, $13::JSON, $14::BOOLEAN, $15::TIMESTAMP WITH TIME ZONE) RETURNING schools.id, schools.updated_at]\n[parameters: ('Saka Girls Secondary School', 'sakagirlssecschol@gmail.com', '+254723456789', 'SCH-2024-007', <SchoolType.SECONDARY: 'secondary'>, Url('http://sakagirlssecondaryschool.com/'), <SchoolStatus.ACTIVE: 'active'>, '123 Saka Road, Northern County', 'Northern County', '00100', 'Standard 8-4-4', '{\"start\": 1, \"end\": 4}', '{\"motto\": \"Education for a brighter future\", \"established\": \"2005\"}', True, datetime.datetime(2024, 12, 31, 5, 57, 55, 313933))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"timestamp": "2024-12-31T06:08:38.267237", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T06:08:38.836881", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 203, "message": "Failed to create school: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $6: Url('http://sakagirlssecondaryschool.com... (expected str, got Url)\n[SQL: INSERT INTO schools (name, email, phone, registration_number, school_type, website, status, address, county, postal_code, class_system, class_range, extra_info, is_active, created_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::JSON, $13::JSON, $14::BOOLEAN, $15::TIMESTAMP WITH TIME ZONE) RETURNING schools.id, schools.updated_at]\n[parameters: ('Saka Girls Secondary School', 'sakagirlssecschol@gmail.com', '+254723456789', 'SCH-2024-007', <SchoolType.SECONDARY: 'secondary'>, Url('http://sakagirlssecondaryschool.com/'), <SchoolStatus.ACTIVE: 'active'>, '123 Saka Road, Northern County', 'Northern County', '00100', 'Standard 8-4-4', '{\"start\": 1, \"end\": 4}', '{\"motto\": \"Education for a brighter future\", \"established\": \"2005\"}', True, datetime.datetime(2024, 12, 31, 6, 8, 38, 526915))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"timestamp": "2024-12-31T06:08:38.837653", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $6: Url('http://sakagirlssecondaryschool.com... (expected str, got Url)\n[SQL: INSERT INTO schools (name, email, phone, registration_number, school_type, website, status, address, county, postal_code, class_system, class_range, extra_info, is_active, created_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::JSON, $13::JSON, $14::BOOLEAN, $15::TIMESTAMP WITH TIME ZONE) RETURNING schools.id, schools.updated_at]\n[parameters: ('Saka Girls Secondary School', 'sakagirlssecschol@gmail.com', '+254723456789', 'SCH-2024-007', <SchoolType.SECONDARY: 'secondary'>, Url('http://sakagirlssecondaryschool.com/'), <SchoolStatus.ACTIVE: 'active'>, '123 Saka Road, Northern County', 'Northern County', '00100', 'Standard 8-4-4', '{\"start\": 1, \"end\": 4}', '{\"motto\": \"Education for a brighter future\", \"established\": \"2005\"}', True, datetime.datetime(2024, 12, 31, 6, 8, 38, 526915))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"timestamp": "2024-12-31T06:11:41.257515", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 239, "message": "Token revocation check error: type object 'RevokedToken' has no attribute 'expiration'"}
{"timestamp": "2024-12-31T06:14:45.204862", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 191, "message": "Failed to send welcome email to school: Saka Girls Secondary School"}
{"timestamp": "2024-12-31T06:14:45.205601", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 193, "message": "Created new school: Saka Girls Secondary School with registration number: SCH-2024-007"}
{"timestamp": "2024-12-31T06:21:18.886651", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 324, "message": "Authentication attempt for non-existent user: abdullahiwardere@yahoo.com"}
{"timestamp": "2024-12-31T06:24:04.254745", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 331, "message": "Failed authentication attempt for user: safwaismail8@gmail.com"}
{"timestamp": "2024-12-31T11:14:52.771501", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 364, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2024-12-31T13:36:50.575288", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: 'RateLimiter' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T13:38:23.099066", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: 'RateLimiter' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T13:39:14.015592", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: 'RateLimiter' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T13:39:14.017744", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T13:42:04.126864", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: 'RateLimiter' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T13:42:04.129460", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T13:46:32.184950", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: RateLimiter.check_rate_limit() got an unexpected keyword argument 'max_requests'"}
{"timestamp": "2024-12-31T13:46:32.187742", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T13:51:11.086905", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_account_lockout", "line": 136, "message": "Error checking account lockout: type object 'FailedLoginAttempt' has no attribute 'email'"}
{"timestamp": "2024-12-31T13:51:12.077284", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "clear_failed_attempts", "line": 161, "message": "Error clearing failed attempts: type object 'FailedLoginAttempt' has no attribute 'email'"}
{"timestamp": "2024-12-31T13:51:12.152523", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T13:51:12.167702", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T14:27:15.399394", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T14:27:15.403124", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T16:28:10.569982", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 555, "message": "Authentication error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T16:28:10.602985", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T17:22:35.997003", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "transaction", "line": 45, "message": "Transaction error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T17:22:36.019577", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 432, "message": "Database error during authentication: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T17:22:36.023164", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T17:25:39.050474", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 438, "message": "Authentication error: 'coroutine' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T17:25:39.055622", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T17:41:03.925475", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 441, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T17:41:03.936561", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T17:44:09.041010", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 443, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T17:44:09.043687", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T18:37:00.922865", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 406, "message": "Authentication error: 'NoneType' object has no attribute 'check_rate_limit'"}
{"timestamp": "2024-12-31T18:37:00.928397", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 198, "message": "Unexpected error during login: 500: Authentication failed"}
{"timestamp": "2024-12-31T18:45:47.164507", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 230, "message": "Unexpected error during login: name 'EmailStr' is not defined", "exception": {"type": "NameError", "message": "name 'EmailStr' is not defined", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 166, in login\n    if not isinstance(credentials.email, EmailStr):\n                                         ^^^^^^^^\n", "NameError: name 'EmailStr' is not defined\n"]}}
{"timestamp": "2024-12-31T18:48:27.589796", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 444, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T18:48:27.592340", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: Authentication failed", "exception": {"type": "HTTPException", "message": "500: Authentication failed", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 368, in authenticate_user\n    if not await self.rate_limiter.check_rate_limit(request, \"login\", max_requests=5):\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limiter'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 445, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: Authentication failed\n"]}}
{"timestamp": "2024-12-31T18:54:34.271772", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: name 'ValidationError' is not defined", "exception": {"type": "NameError", "message": "name 'ValidationError' is not defined", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 372, in authenticate_user\n    if not is_valid_email(email):\n           ^^^^^^^^^^^^^^\n", "NameError: name 'is_valid_email' is not defined\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 482, in authenticate_user\n    except ValidationError as e:\n           ^^^^^^^^^^^^^^^\n", "NameError: name 'ValidationError' is not defined\n"]}}
{"timestamp": "2024-12-31T19:05:49.083290", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 444, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T19:05:49.091331", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: Authentication failed", "exception": {"type": "HTTPException", "message": "500: Authentication failed", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 368, in authenticate_user\n    if not await self.rate_limiter.check_rate_limit(request, \"login\", max_requests=5):\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limiter'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 445, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: Authentication failed\n"]}}
{"timestamp": "2024-12-31T19:22:53.960130", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: name 'AccountLockedException' is not defined", "exception": {"type": "NameError", "message": "name 'AccountLockedException' is not defined", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 388, in authenticate_user\n    if not await self.rate_limiter.check_rate_limit(request, \"login\", max_requests=5):\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limiter'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 455, in authenticate_user\n    except AccountLockedException:\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "NameError: name 'AccountLockedException' is not defined\n"]}}
{"timestamp": "2024-12-31T19:23:32.638857", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 468, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T19:23:32.639836", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: Authentication failed", "exception": {"type": "HTTPException", "message": "500: Authentication failed", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 388, in authenticate_user\n    if not await self.rate_limiter.check_rate_limit(request, \"login\", max_requests=5):\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limiter'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 469, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: Authentication failed\n"]}}
{"timestamp": "2024-12-31T19:27:47.687474", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 468, "message": "Authentication error: 'AuthService' object has no attribute 'rate_limiter'"}
{"timestamp": "2024-12-31T19:27:47.704021", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: Authentication failed", "exception": {"type": "HTTPException", "message": "500: Authentication failed", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 388, in authenticate_user\n    if not await self.rate_limiter.check_rate_limit(request, \"login\", max_requests=5):\n                 ^^^^^^^^^^^^^^^^^\n", "AttributeError: 'AuthService' object has no attribute 'rate_limiter'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 469, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: Authentication failed\n"]}}
{"timestamp": "2024-12-31T19:33:27.877470", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "initialize", "line": 75, "message": "Failed to initialize AuthService: Missing required JWT settings: SECRET_KEY, ALGORITHM, ACCESS_TOKEN_EXPIRE_MINUTES, REFRESH_TOKEN_EXPIRE_DAYS, FAILED_ATTEMPTS, DURATION_MINUTES, RATE_LIMIT_MAX_REQUESTS, RATE_LIMIT_TIME_WINDOW"}
{"timestamp": "2024-12-31T19:33:27.885216", "level": "CRITICAL", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 217, "message": "Configuration error during login: Failed to initialize authentication service"}
{"timestamp": "2024-12-31T19:45:08.225154", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "transaction", "line": 57, "message": "Transaction error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T19:45:08.232304", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 396, "message": "Database error during authentication: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2024-12-31T19:45:08.233100", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: Authentication failed", "exception": {"type": "HTTPException", "message": "500: Authentication failed", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 363, in authenticate_user\n    sub=str(user.id),\n            ^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 566, in __get__\n    return self.impl.get(state, dict_)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1086, in get\n    value = self._fire_loader_callables(state, key, passive)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1116, in _fire_loader_callables\n    return state._load_expired(state, passive)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py\", line 803, in _load_expired\n    self.manager.expired_attribute_loader(self, toload, passive)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 1670, in load_scalar_attributes\n    result = load_on_ident(\n             ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 509, in load_on_ident\n    return load_on_pk_identity(\n           ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 694, in load_on_pk_identity\n    session.execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2362, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2247, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py\", line 305, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2358, in _handle_dbapi_exception\n    raise exc_info[1].with_traceback(exc_info[2])\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 572, in execute\n    self._adapt_connection.await_(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 123, in await_only\n    raise exc.MissingGreenlet(\n", "sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 397, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: Authentication failed\n"]}}
