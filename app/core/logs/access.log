{"timestamp": "2025-01-01T04:57:43.054973", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 410, "message": "Unexpected authentication error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2025-01-01T04:57:43.069345", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: name 'SQLAlchemyError' is not defined", "exception": {"type": "NameError", "message": "name 'SQLAlchemyError' is not defined", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 379, in authenticate_user\n    sub=str(user.id),\n            ^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 566, in __get__\n    return self.impl.get(state, dict_)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1086, in get\n    value = self._fire_loader_callables(state, key, passive)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1116, in _fire_loader_callables\n    return state._load_expired(state, passive)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py\", line 803, in _load_expired\n    self.manager.expired_attribute_loader(self, toload, passive)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 1670, in load_scalar_attributes\n    result = load_on_ident(\n             ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 509, in load_on_ident\n    return load_on_pk_identity(\n           ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 694, in load_on_pk_identity\n    session.execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2362, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2247, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py\", line 305, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2358, in _handle_dbapi_exception\n    raise exc_info[1].with_traceback(exc_info[2])\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 572, in execute\n    self._adapt_connection.await_(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 123, in await_only\n    raise exc.MissingGreenlet(\n", "sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 413, in authenticate_user\n    detail=get_error_message(\"authentication_failed\", language)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/core/errors.py\", line 192, in get_error_message\n    elif isinstance(error, SQLAlchemyError):\n                           ^^^^^^^^^^^^^^^\n", "NameError: name 'SQLAlchemyError' is not defined\n"]}}
{"timestamp": "2025-01-01T05:00:18.928693", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 410, "message": "Unexpected authentication error: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)"}
{"timestamp": "2025-01-01T05:00:18.933124", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 224, "message": "Unexpected error during login: 500: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'authentication_failed', 'status_code': 500}", "exception": {"type": "HTTPException", "message": "500: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'authentication_failed', 'status_code': 500}", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 379, in authenticate_user\n    sub=str(user.id),\n            ^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 566, in __get__\n    return self.impl.get(state, dict_)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1086, in get\n    value = self._fire_loader_callables(state, key, passive)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py\", line 1116, in _fire_loader_callables\n    return state._load_expired(state, passive)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py\", line 803, in _load_expired\n    self.manager.expired_attribute_loader(self, toload, passive)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 1670, in load_scalar_attributes\n    result = load_on_ident(\n             ^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 509, in load_on_ident\n    return load_on_pk_identity(\n           ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/loading.py\", line 694, in load_on_pk_identity\n    session.execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2362, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2247, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/context.py\", line 305, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2358, in _handle_dbapi_exception\n    raise exc_info[1].with_traceback(exc_info[2])\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 572, in execute\n    self._adapt_connection.await_(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 123, in await_only\n    raise exc.MissingGreenlet(\n", "sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/auth.py\", line 173, in login\n    auth_result = await auth_service.authenticate_user(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 411, in authenticate_user\n    raise HTTPException(\n", "fastapi.exceptions.HTTPException: 500: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'authentication_failed', 'status_code': 500}\n"]}}
{"timestamp": "2025-01-01T05:11:12.005013", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 397, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T05:51:37.510878", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 427, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T05:53:47.224484", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 427, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T06:09:14.050663", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 302, "message": "Token creation value error: Token must include user identifier (sub)"}
{"timestamp": "2025-01-01T06:09:14.055482", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 487, "message": "Authentication failed for mikailismail260@gmail.com: Token must include user identifier (sub)"}
{"timestamp": "2025-01-01T06:48:34.286265", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 465, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T06:48:34.291308", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 305, "message": "Error creating access token: Logger._log() got an unexpected keyword argument 'type'"}
{"timestamp": "2025-01-01T06:48:34.292740", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 489, "message": "Authentication failed for mikailismail260@gmail.com: Could not create access token"}
{"timestamp": "2025-01-01T06:52:42.332306", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 472, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T06:52:42.339884", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 294, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T06:52:42.406845", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 294, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T06:52:42.407875", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 486, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T06:54:41.483226", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 366, "message": "Unexpected token verification error: Logger._log() got an unexpected keyword argument 'type'"}
{"timestamp": "2025-01-01T06:58:00.546627", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T06:58:00.799940", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T06:58:42.616812", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T06:58:42.652761", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T07:03:09.693490", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T07:03:09.795740", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T07:05:27.859498", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T07:05:28.038480", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T07:09:12.354299", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T07:09:12.444538", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 218, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T07:09:12.448254", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: name 'HTTPException' is not defined"}
{"timestamp": "2025-01-01T08:05:07.873710", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 354, "message": "Token expired"}
{"timestamp": "2025-01-01T08:06:00.880344", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 474, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T08:06:00.880874", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 294, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:06:00.881806", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 294, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:06:00.882578", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 488, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T08:06:45.006400", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T08:06:45.320956", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 219, "message": "Error creating school: 'ClassRange' object has no attribute 'get'"}
{"timestamp": "2025-01-01T08:06:45.323252", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "admin", "function": "create_school", "line": 75, "message": "Error creating school: name 'status' is not defined"}
{"timestamp": "2025-01-01T08:08:56.875138", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 342, "message": "Token verified", "user_id": "1"}
{"timestamp": "2025-01-01T08:12:00.838529", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 189, "message": "Failed to send welcome email to school: Hafsa Junior Academy"}
{"timestamp": "2025-01-01T08:12:00.842869", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "school_service", "function": "create_school", "line": 191, "message": "Created new school: Hafsa Junior Academy with registration number: SCH-2025-001"}
{"timestamp": "2025-01-01T08:24:59.963357", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 238, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (1, null, 2025-01-01 00:24:59.892518-08, 127.0.0.1, null, hafswirakullow@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('hafswirakullow@gmail.com', datetime.datetime(2025, 1, 1, 8, 24, 59, 892518, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:24:59.976601", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 498, "message": "Authentication failed for hafswirakullow@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:27:05.485025", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 238, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (2, null, 2025-01-01 00:27:05.445989-08, 127.0.0.1, null, hafswirakullow@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('hafswirakullow@gmail.com', datetime.datetime(2025, 1, 1, 8, 27, 5, 445989, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:27:05.493227", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 498, "message": "Authentication failed for hafswirakullow@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:35:41.847420", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (3, null, 2025-01-01 00:35:41.797731-08, 127.0.0.1, null, hafswirakullow@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('hafswirakullow@gmail.com', datetime.datetime(2025, 1, 1, 8, 35, 41, 797731, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:35:41.857543", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 546, "message": "Authentication failed for hafswirakullow@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:36:09.114763", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 522, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T08:36:09.116996", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 342, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:36:09.271646", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 342, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:36:09.274254", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 536, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T08:37:30.909094", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 532, "message": "Token data: {'sub': '1', 'email': 'mikailismail260@gmail.com', 'role': <UserRole.SUPER_ADMIN: 'super_admin'>, 'school_id': '1', 'user_id': 1}"}
{"timestamp": "2025-01-01T08:37:30.913119", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 342, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:37:30.931316", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 342, "message": "Creating token", "user_id": "1"}
{"timestamp": "2025-01-01T08:37:30.932222", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 546, "message": "User authenticated successfully: mikailismail260@gmail.com"}
{"timestamp": "2025-01-01T08:38:34.744681", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (4, null, 2025-01-01 00:38:34.64874-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 34, 648740, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:34.749890", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:40.176481", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (5, null, 2025-01-01 00:38:40.172827-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 40, 172827, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:40.179821", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:42.446874", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (6, null, 2025-01-01 00:38:42.433446-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 42, 433446, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:42.450111", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:44.348765", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (7, null, 2025-01-01 00:38:44.346156-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 44, 346156, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:44.349359", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:46.286052", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (8, null, 2025-01-01 00:38:46.27594-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 46, 275940, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:46.288061", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:48.394729", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (9, null, 2025-01-01 00:38:48.390929-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 48, 390929, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:48.398120", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:50.797439", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (10, null, 2025-01-01 00:38:50.791173-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 50, 791173, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:50.804573", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:53.239327", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (11, null, 2025-01-01 00:38:53.231582-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 53, 231582, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:53.241594", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
{"timestamp": "2025-01-01T08:38:55.386302", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "record_failed_attempt", "line": 286, "message": "Error recording failed attempt: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"school_id\" of relation \"failed_login_attempts\" violates not-null constraint\nDETAIL:  Failing row contains (12, null, 2025-01-01 00:38:55.383954-08, 127.0.0.1, null, mikailismail260@gmail.com).\n[SQL: INSERT INTO failed_login_attempts (email, timestamp, ip_address, user_id, school_id) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::INTEGER, $5::INTEGER) RETURNING failed_login_attempts.id]\n[parameters: ('mikailismail260@gmail.com', datetime.datetime(2025, 1, 1, 8, 38, 55, 383954, tzinfo=datetime.timezone.utc), '127.0.0.1', None, None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-01-01T08:38:55.387870", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 556, "message": "Authentication failed for mikailismail260@gmail.com: {'success': False, 'error_code': 'GENERAL_ERROR', 'message': 'invalid_credentials', 'status_code': 500}"}
