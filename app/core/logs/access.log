{"timestamp": "2025-01-18T06:28:01.296163", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 216, "message": "Login attempt initiated", "request_id": "e614daa5-1c45-46d8-b8ac-d7919d8fc46e"}
{"timestamp": "2025-01-18T06:28:02.047472", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 710, "message": "Generating tokens", "user_id": "24"}
{"timestamp": "2025-01-18T06:28:02.086250", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 448, "message": "Token created successfully", "user_id": "24"}
{"timestamp": "2025-01-18T06:28:02.090040", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 448, "message": "Token created successfully", "user_id": "24"}
{"timestamp": "2025-01-18T06:28:02.091444", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 727, "message": "Token expiration times"}
{"timestamp": "2025-01-18T06:28:02.093115", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 767, "message": "User logged in successfully", "user_id": "24"}
{"timestamp": "2025-01-18T06:28:02.096886", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 236, "message": "Login successful", "request_id": "e614daa5-1c45-46d8-b8ac-d7919d8fc46e", "user_id": "24"}
{"timestamp": "2025-01-18T06:28:47.691811", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T06:28:47.696075", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T06:28:47.744632", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T06:28:47.817399", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 48, "message": "Searching for session at: Date=2025-01-18, Time=09:28:47, Day=SATURDAY"}
{"timestamp": "2025-01-18T06:28:47.858257", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 55, "message": "Total sessions for school: 7"}
{"timestamp": "2025-01-18T06:28:47.859316", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 1 Session:\n  ID: 1\n  Active: True\n  Time: 08:00:00-08:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:28:47.861390", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 2 Session:\n  ID: 2\n  Active: True\n  Time: 09:00:00-09:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:28:47.862764", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Maths:\n  ID: 3\n  Active: True\n  Time: 08:00:00-12:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:28:47.864051", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 1 Night:\n  ID: 4\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:28:47.865323", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term1 Night:\n  ID: 5\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2025-01-15-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:28:47.866279", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Late Night Study:\n  ID: 6\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:28:47.867461", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Late Night Study:\n  ID: 7\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:28:47.875149", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 73, "message": "Sessions after active check: ['Term 1 Session', 'Term 2 Session', 'Maths', 'Term 1 Night', 'Term1 Night', 'Late Night Study', 'Late Night Study']"}
{"timestamp": "2025-01-18T06:28:47.887034", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 82, "message": "Sessions after date check: ['Term1 Night', 'Late Night Study']"}
{"timestamp": "2025-01-18T06:28:47.897283", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 97, "message": "Found 2 potentially active sessions"}
{"timestamp": "2025-01-18T06:28:47.899117", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 09:28:47 against session 22:00:00-22:40:00"}
{"timestamp": "2025-01-18T06:28:47.900418", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: False"}
{"timestamp": "2025-01-18T06:28:47.901817", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session Term1 Night (ID: 5):\n  Time match: False\n  Day match: False\n  Current time: 09:28:47, Session time: 22:00:00-22:40:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-15, End date: 2025-04-15"}
{"timestamp": "2025-01-18T06:28:47.904064", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 09:28:47 against session 23:00:00-04:00:00"}
{"timestamp": "2025-01-18T06:28:47.906175", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: False"}
{"timestamp": "2025-01-18T06:28:47.907341", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session Late Night Study (ID: 7):\n  Time match: False\n  Day match: False\n  Current time: 09:28:47, Session time: 23:00:00-04:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T06:28:47.908713", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 117, "message": "No matching active session found"}
{"timestamp": "2025-01-18T06:30:03.519861", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T06:30:03.525997", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T06:30:03.554894", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T06:32:45.760697", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T06:32:45.765609", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T06:32:45.790865", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T06:33:44.261656", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T06:33:44.264817", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T06:33:44.292010", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T06:34:24.843350", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T06:34:24.845907", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T06:34:24.882941", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T06:34:24.991012", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 48, "message": "Searching for session at: Date=2025-01-18, Time=09:34:24, Day=SATURDAY"}
{"timestamp": "2025-01-18T06:34:24.998235", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 55, "message": "Total sessions for school: 8"}
{"timestamp": "2025-01-18T06:34:25.000422", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 1 Session:\n  ID: 1\n  Active: True\n  Time: 08:00:00-08:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:34:25.001767", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 2 Session:\n  ID: 2\n  Active: True\n  Time: 09:00:00-09:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:34:25.002982", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Maths:\n  ID: 3\n  Active: True\n  Time: 08:00:00-12:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:34:25.004688", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 1 Night:\n  ID: 4\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:34:25.006169", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term1 Night:\n  ID: 5\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2025-01-15-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:34:25.007585", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Late Night Study:\n  ID: 6\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:34:25.008541", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Late Night Study:\n  ID: 7\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:34:25.009589", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session  Mid-morning:\n  ID: 8\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:34:25.018460", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 73, "message": "Sessions after active check: ['Term 1 Session', 'Term 2 Session', 'Maths', 'Term 1 Night', 'Term1 Night', 'Late Night Study', 'Late Night Study', ' Mid-morning']"}
{"timestamp": "2025-01-18T06:34:25.025606", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 82, "message": "Sessions after date check: ['Term1 Night', 'Late Night Study', ' Mid-morning']"}
{"timestamp": "2025-01-18T06:34:25.034740", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 97, "message": "Found 3 potentially active sessions"}
{"timestamp": "2025-01-18T06:34:25.036256", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 09:34:24 against session 22:00:00-22:40:00"}
{"timestamp": "2025-01-18T06:34:25.036917", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: False"}
{"timestamp": "2025-01-18T06:34:25.037931", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session Term1 Night (ID: 5):\n  Time match: False\n  Day match: False\n  Current time: 09:34:24, Session time: 22:00:00-22:40:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-15, End date: 2025-04-15"}
{"timestamp": "2025-01-18T06:34:25.038893", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 09:34:24 against session 23:00:00-04:00:00"}
{"timestamp": "2025-01-18T06:34:25.039645", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: False"}
{"timestamp": "2025-01-18T06:34:25.040515", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session Late Night Study (ID: 7):\n  Time match: False\n  Day match: False\n  Current time: 09:34:24, Session time: 23:00:00-04:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T06:34:25.041838", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 09:34:24 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T06:34:25.046631", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: True"}
{"timestamp": "2025-01-18T06:34:25.048289", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session  Mid-morning (ID: 8):\n  Time match: True\n  Day match: False\n  Current time: 09:34:24, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T06:34:25.051365", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 117, "message": "No matching active session found"}
{"timestamp": "2025-01-18T06:51:34.288772", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T06:51:34.334849", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T06:51:34.385658", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T06:52:51.827795", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T06:52:51.832370", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T06:52:51.848420", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T06:54:36.874016", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T06:54:36.877259", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T06:54:36.892453", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T06:55:00.012829", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T06:55:00.013793", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T06:55:00.029174", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T06:57:03.967853", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T06:57:03.969273", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T06:57:03.982399", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T06:57:04.034279", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 48, "message": "Searching for session at: Date=2025-01-18, Time=09:57:04, Day=SATURDAY"}
{"timestamp": "2025-01-18T06:57:04.037896", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 55, "message": "Total sessions for school: 9"}
{"timestamp": "2025-01-18T06:57:04.038907", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 1 Session:\n  ID: 1\n  Active: True\n  Time: 08:00:00-08:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:57:04.039235", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 2 Session:\n  ID: 2\n  Active: True\n  Time: 09:00:00-09:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:57:04.039500", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Maths:\n  ID: 3\n  Active: True\n  Time: 08:00:00-12:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:57:04.039746", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 1 Night:\n  ID: 4\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:57:04.039983", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term1 Night:\n  ID: 5\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2025-01-15-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:57:04.040214", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Late Night Study:\n  ID: 6\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:57:04.040536", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Late Night Study:\n  ID: 7\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:57:04.040768", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session  Mid-morning:\n  ID: 8\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:57:04.040992", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Late Night Study:\n  ID: 9\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T06:57:04.043265", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 73, "message": "Sessions after active check: ['Term 1 Session', 'Term 2 Session', 'Maths', 'Term 1 Night', 'Term1 Night', 'Late Night Study', 'Late Night Study', ' Mid-morning', 'Late Night Study']"}
{"timestamp": "2025-01-18T06:57:04.048557", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 82, "message": "Sessions after date check: ['Term1 Night', 'Late Night Study', ' Mid-morning', 'Late Night Study']"}
{"timestamp": "2025-01-18T06:57:04.053049", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 97, "message": "Found 4 potentially active sessions"}
{"timestamp": "2025-01-18T06:57:04.054133", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 09:57:04 against session 22:00:00-22:40:00"}
{"timestamp": "2025-01-18T06:57:04.054592", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: False"}
{"timestamp": "2025-01-18T06:57:04.055085", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session Term1 Night (ID: 5):\n  Time match: False\n  Day match: False\n  Current time: 09:57:04, Session time: 22:00:00-22:40:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-15, End date: 2025-04-15"}
{"timestamp": "2025-01-18T06:57:04.055395", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 09:57:04 against session 23:00:00-04:00:00"}
{"timestamp": "2025-01-18T06:57:04.055703", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: False"}
{"timestamp": "2025-01-18T06:57:04.056073", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session Late Night Study (ID: 7):\n  Time match: False\n  Day match: False\n  Current time: 09:57:04, Session time: 23:00:00-04:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T06:57:04.056367", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 09:57:04 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T06:57:04.056612", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: True"}
{"timestamp": "2025-01-18T06:57:04.056926", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session  Mid-morning (ID: 8):\n  Time match: True\n  Day match: False\n  Current time: 09:57:04, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T06:57:04.057220", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 09:57:04 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T06:57:04.057496", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: True"}
{"timestamp": "2025-01-18T06:57:04.057838", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session Late Night Study (ID: 9):\n  Time match: True\n  Day match: True\n  Current time: 09:57:04, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['SATURDAY', 'SUNDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T06:57:04.058825", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 114, "message": "Found matching session: Late Night Study"}
{"timestamp": "2025-01-18T06:57:04.104763", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 09:57:04 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T06:57:04.105456", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: True"}
{"timestamp": "2025-01-18T06:57:04.107885", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "mark_attendance", "line": 203, "message": "Validating session Late Night Study:\n  Time match: True\n  Day match: True\n  Date match: True\n  Current time: 09:57:04, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['SATURDAY', 'SUNDAY']"}
{"timestamp": "2025-01-18T06:57:04.386438", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "attendance", "function": "mark_student_attendance", "line": 154, "message": "Unexpected error in mark_student_attendance", "exception": {"type": "AttributeError", "message": "'Session' object has no attribute 'class_id'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/attendance.py\", line 140, in mark_student_attendance\n    class_id=session.class_id,\n           ^^^^^^^^^^^^^^^^\n", "AttributeError: 'Session' object has no attribute 'class_id'\n"]}}
{"timestamp": "2025-01-18T07:26:50.180132", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T07:26:50.200710", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 563, "message": "Unexpected error during token verification", "exception": {"type": "AttributeError", "message": "module 'jose.jwt' has no attribute 'InvalidIssuerError'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 496, in verify_token\n    payload = jwt.decode(\n              ^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 157, in decode\n    _validate_claims(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 481, in _validate_claims\n    _validate_exp(claims, leeway=leeway)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 314, in _validate_exp\n    raise ExpiredSignatureError(\"Signature has expired.\")\n", "jose.exceptions.ExpiredSignatureError: Signature has expired.\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 503, in verify_token\n    except jwt.InvalidIssuerError:\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: module 'jose.jwt' has no attribute 'InvalidIssuerError'\n"]}}
{"timestamp": "2025-01-18T07:26:50.220567", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 1005, "message": "Unexpected error during token validation: 401: Could not validate credentials"}
{"timestamp": "2025-01-18T07:26:50.221129", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "dispatch", "line": 95, "message": "Authentication failed: Token validation failed"}
{"timestamp": "2025-01-18T07:27:30.875850", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 216, "message": "Login attempt initiated", "request_id": "9d9159a6-d6e8-4145-abb0-d81c7223b6fe"}
{"timestamp": "2025-01-18T07:27:31.279584", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 710, "message": "Generating tokens", "user_id": "24"}
{"timestamp": "2025-01-18T07:27:31.296025", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 448, "message": "Token created successfully", "user_id": "24"}
{"timestamp": "2025-01-18T07:27:31.296567", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 448, "message": "Token created successfully", "user_id": "24"}
{"timestamp": "2025-01-18T07:27:31.296934", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 727, "message": "Token expiration times"}
{"timestamp": "2025-01-18T07:27:31.297496", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 767, "message": "User logged in successfully", "user_id": "24"}
{"timestamp": "2025-01-18T07:27:31.301248", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 236, "message": "Login successful", "request_id": "9d9159a6-d6e8-4145-abb0-d81c7223b6fe", "user_id": "24"}
{"timestamp": "2025-01-18T07:28:24.711397", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T07:28:24.714925", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T07:28:24.734682", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T07:28:24.782214", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 48, "message": "Searching for session at: Date=2025-01-18, Time=10:28:24, Day=SATURDAY"}
{"timestamp": "2025-01-18T07:28:24.808929", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 55, "message": "Total sessions for school: 9"}
{"timestamp": "2025-01-18T07:28:24.809659", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 1 Session:\n  ID: 1\n  Active: True\n  Time: 08:00:00-08:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:28:24.810042", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 2 Session:\n  ID: 2\n  Active: True\n  Time: 09:00:00-09:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:28:24.810431", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Maths:\n  ID: 3\n  Active: True\n  Time: 08:00:00-12:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:28:24.810976", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term 1 Night:\n  ID: 4\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:28:24.811286", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Term1 Night:\n  ID: 5\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2025-01-15-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:28:24.811562", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Late Night Study:\n  ID: 6\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:28:24.811876", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Late Night Study:\n  ID: 7\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:28:24.812118", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session  Mid-morning:\n  ID: 8\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:28:24.812344", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 57, "message": "Session Late Night Study:\n  ID: 9\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:28:24.817567", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 73, "message": "Sessions after active check: ['Term 1 Session', 'Term 2 Session', 'Maths', 'Term 1 Night', 'Term1 Night', 'Late Night Study', 'Late Night Study', ' Mid-morning', 'Late Night Study']"}
{"timestamp": "2025-01-18T07:28:24.822471", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 82, "message": "Sessions after date check: ['Term1 Night', 'Late Night Study', ' Mid-morning', 'Late Night Study']"}
{"timestamp": "2025-01-18T07:28:24.825124", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 97, "message": "Found 4 potentially active sessions"}
{"timestamp": "2025-01-18T07:28:24.825600", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 10:28:24 against session 22:00:00-22:40:00"}
{"timestamp": "2025-01-18T07:28:24.825833", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: False"}
{"timestamp": "2025-01-18T07:28:24.826120", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session Term1 Night (ID: 5):\n  Time match: False\n  Day match: False\n  Current time: 10:28:24, Session time: 22:00:00-22:40:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-15, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:28:24.826356", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 10:28:24 against session 23:00:00-04:00:00"}
{"timestamp": "2025-01-18T07:28:24.826601", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: False"}
{"timestamp": "2025-01-18T07:28:24.826911", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session Late Night Study (ID: 7):\n  Time match: False\n  Day match: False\n  Current time: 10:28:24, Session time: 23:00:00-04:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:28:24.827246", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 10:28:24 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:28:24.827455", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:28:24.827749", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session  Mid-morning (ID: 8):\n  Time match: True\n  Day match: False\n  Current time: 10:28:24, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:28:24.828011", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 10:28:24 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:28:24.828248", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:28:24.828508", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 104, "message": "Checking session Late Night Study (ID: 9):\n  Time match: True\n  Day match: True\n  Current time: 10:28:24, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['SATURDAY', 'SUNDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:28:24.829032", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 114, "message": "Found matching session: Late Night Study"}
{"timestamp": "2025-01-18T07:28:24.842344", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 122, "message": "Checking time 10:28:24 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:28:24.842683", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 131, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:28:24.842928", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "mark_attendance", "line": 213, "message": "Validating session Late Night Study:\n  Time match: True\n  Day match: True\n  Date match: True\n  Current time: 10:28:24, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['SATURDAY', 'SUNDAY']"}
{"timestamp": "2025-01-18T07:28:24.928495", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "attendance", "function": "mark_student_attendance", "line": 163, "message": "Unexpected error in mark_student_attendance", "exception": {"type": "AttributeError", "message": "'StudentAttendance' object has no attribute 'class_name'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/attendance.py\", line 152, in mark_student_attendance\n    class_name=attendance.class_name,\n               ^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'StudentAttendance' object has no attribute 'class_name'\n"]}}
{"timestamp": "2025-01-18T07:32:30.723354", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T07:32:30.734813", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T07:32:30.751913", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T07:32:30.919751", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 51, "message": "Searching for session at: Date=2025-01-18, Time=10:32:30, Day=SATURDAY"}
{"timestamp": "2025-01-18T07:32:30.943353", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 58, "message": "Total sessions for school: 9"}
{"timestamp": "2025-01-18T07:32:30.944251", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term 1 Session:\n  ID: 1\n  Active: True\n  Time: 08:00:00-08:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:32:30.944833", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term 2 Session:\n  ID: 2\n  Active: True\n  Time: 09:00:00-09:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:32:30.945453", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Maths:\n  ID: 3\n  Active: True\n  Time: 08:00:00-12:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:32:30.946069", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term 1 Night:\n  ID: 4\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:32:30.946780", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term1 Night:\n  ID: 5\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2025-01-15-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:32:30.947550", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Late Night Study:\n  ID: 6\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:32:30.948242", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Late Night Study:\n  ID: 7\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:32:30.949401", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session  Mid-morning:\n  ID: 8\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:32:30.950417", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Late Night Study:\n  ID: 9\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:32:30.957946", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 76, "message": "Sessions after active check: ['Term 1 Session', 'Term 2 Session', 'Maths', 'Term 1 Night', 'Term1 Night', 'Late Night Study', 'Late Night Study', ' Mid-morning', 'Late Night Study']"}
{"timestamp": "2025-01-18T07:32:30.965416", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 85, "message": "Sessions after date check: ['Term1 Night', 'Late Night Study', ' Mid-morning', 'Late Night Study']"}
{"timestamp": "2025-01-18T07:32:30.971697", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 100, "message": "Found 4 potentially active sessions"}
{"timestamp": "2025-01-18T07:32:30.973531", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:32:30 against session 22:00:00-22:40:00"}
{"timestamp": "2025-01-18T07:32:30.974091", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: False"}
{"timestamp": "2025-01-18T07:32:30.974823", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session Term1 Night (ID: 5):\n  Time match: False\n  Day match: False\n  Current time: 10:32:30, Session time: 22:00:00-22:40:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-15, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:32:30.975559", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:32:30 against session 23:00:00-04:00:00"}
{"timestamp": "2025-01-18T07:32:30.976098", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: False"}
{"timestamp": "2025-01-18T07:32:30.976779", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session Late Night Study (ID: 7):\n  Time match: False\n  Day match: False\n  Current time: 10:32:30, Session time: 23:00:00-04:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:32:30.977490", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:32:30 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:32:30.977983", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:32:30.978431", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session  Mid-morning (ID: 8):\n  Time match: True\n  Day match: False\n  Current time: 10:32:30, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:32:30.979030", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:32:30 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:32:30.979449", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:32:30.979893", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session Late Night Study (ID: 9):\n  Time match: True\n  Day match: True\n  Current time: 10:32:30, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['SATURDAY', 'SUNDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:32:30.980224", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 117, "message": "Found matching session: Late Night Study"}
{"timestamp": "2025-01-18T07:32:31.006773", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:32:31 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:32:31.007363", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:32:31.008169", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "mark_attendance", "line": 236, "message": "Validating session Late Night Study:\n  Time match: True\n  Day match: True\n  Date match: True\n  Current time: 10:32:31, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['SATURDAY', 'SUNDAY']"}
{"timestamp": "2025-01-18T07:32:31.056882", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "attendance", "function": "mark_student_attendance", "line": 162, "message": "Unexpected error in mark_student_attendance", "exception": {"type": "ValidationError", "message": "2 validation errors for AttendanceInfo\nsession_id\n  Field required [type=missing, input_value={'student_id': 2, 'class_...tudent arrived on time'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.9/v/missing\nschool_id\n  Field required [type=missing, input_value={'student_id': 2, 'class_...tudent arrived on time'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.9/v/missing", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/attendance.py\", line 146, in mark_student_attendance\n    return AttendanceInfo(\n           ^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/pydantic/main.py\", line 212, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "pydantic_core._pydantic_core.ValidationError: 2 validation errors for AttendanceInfo\nsession_id\n  Field required [type=missing, input_value={'student_id': 2, 'class_...tudent arrived on time'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.9/v/missing\nschool_id\n  Field required [type=missing, input_value={'student_id': 2, 'class_...tudent arrived on time'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.9/v/missing\n"]}}
{"timestamp": "2025-01-18T07:36:20.270708", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T07:36:20.276232", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T07:36:20.299307", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T07:36:20.397448", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 51, "message": "Searching for session at: Date=2025-01-18, Time=10:36:20, Day=SATURDAY"}
{"timestamp": "2025-01-18T07:36:20.408246", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 58, "message": "Total sessions for school: 9"}
{"timestamp": "2025-01-18T07:36:20.408604", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term 1 Session:\n  ID: 1\n  Active: True\n  Time: 08:00:00-08:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:36:20.408903", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term 2 Session:\n  ID: 2\n  Active: True\n  Time: 09:00:00-09:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:36:20.409155", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Maths:\n  ID: 3\n  Active: True\n  Time: 08:00:00-12:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:36:20.409423", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term 1 Night:\n  ID: 4\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:36:20.409822", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term1 Night:\n  ID: 5\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2025-01-15-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:36:20.410060", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Late Night Study:\n  ID: 6\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:36:20.410364", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Late Night Study:\n  ID: 7\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:36:20.410607", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session  Mid-morning:\n  ID: 8\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:36:20.410967", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Late Night Study:\n  ID: 9\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:36:20.413875", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 76, "message": "Sessions after active check: ['Term 1 Session', 'Term 2 Session', 'Maths', 'Term 1 Night', 'Term1 Night', 'Late Night Study', 'Late Night Study', ' Mid-morning', 'Late Night Study']"}
{"timestamp": "2025-01-18T07:36:20.417181", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 85, "message": "Sessions after date check: ['Term1 Night', 'Late Night Study', ' Mid-morning', 'Late Night Study']"}
{"timestamp": "2025-01-18T07:36:20.423456", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 100, "message": "Found 4 potentially active sessions"}
{"timestamp": "2025-01-18T07:36:20.423793", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:36:20 against session 22:00:00-22:40:00"}
{"timestamp": "2025-01-18T07:36:20.424112", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: False"}
{"timestamp": "2025-01-18T07:36:20.424417", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session Term1 Night (ID: 5):\n  Time match: False\n  Day match: False\n  Current time: 10:36:20, Session time: 22:00:00-22:40:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-15, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:36:20.424674", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:36:20 against session 23:00:00-04:00:00"}
{"timestamp": "2025-01-18T07:36:20.424919", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: False"}
{"timestamp": "2025-01-18T07:36:20.425164", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session Late Night Study (ID: 7):\n  Time match: False\n  Day match: False\n  Current time: 10:36:20, Session time: 23:00:00-04:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:36:20.425440", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:36:20 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:36:20.425694", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:36:20.425999", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session  Mid-morning (ID: 8):\n  Time match: True\n  Day match: False\n  Current time: 10:36:20, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:36:20.426291", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:36:20 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:36:20.426615", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:36:20.426935", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session Late Night Study (ID: 9):\n  Time match: True\n  Day match: True\n  Current time: 10:36:20, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['SATURDAY', 'SUNDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:36:20.427231", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 117, "message": "Found matching session: Late Night Study"}
{"timestamp": "2025-01-18T07:36:20.440774", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:36:20 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:36:20.441371", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:36:20.441822", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "mark_attendance", "line": 236, "message": "Validating session Late Night Study:\n  Time match: True\n  Day match: True\n  Date match: True\n  Current time: 10:36:20, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['SATURDAY', 'SUNDAY']"}
{"timestamp": "2025-01-18T07:36:20.494876", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "attendance", "function": "mark_student_attendance", "line": 165, "message": "Unexpected error in mark_student_attendance", "exception": {"type": "ValidationError", "message": "2 validation errors for AttendanceInfo\nclass_id\n  Input should be a valid string [type=string_type, input_value=1, input_type=int]\n    For further information visit https://errors.pydantic.dev/2.9/v/string_type\nstream_id\n  Input should be a valid string [type=string_type, input_value=2, input_type=int]\n    For further information visit https://errors.pydantic.dev/2.9/v/string_type", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/routes/attendance.py\", line 147, in mark_student_attendance\n    return AttendanceInfo(\n           ^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/pydantic/main.py\", line 212, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "pydantic_core._pydantic_core.ValidationError: 2 validation errors for AttendanceInfo\nclass_id\n  Input should be a valid string [type=string_type, input_value=1, input_type=int]\n    For further information visit https://errors.pydantic.dev/2.9/v/string_type\nstream_id\n  Input should be a valid string [type=string_type, input_value=2, input_type=int]\n    For further information visit https://errors.pydantic.dev/2.9/v/string_type\n"]}}
{"timestamp": "2025-01-18T07:38:47.975433", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T07:38:48.198282", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T07:38:48.263957", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T07:38:48.491678", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 51, "message": "Searching for session at: Date=2025-01-18, Time=10:38:48, Day=SATURDAY"}
{"timestamp": "2025-01-18T07:38:48.507208", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 58, "message": "Total sessions for school: 9"}
{"timestamp": "2025-01-18T07:38:48.507754", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term 1 Session:\n  ID: 1\n  Active: True\n  Time: 08:00:00-08:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:38:48.508219", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term 2 Session:\n  ID: 2\n  Active: True\n  Time: 09:00:00-09:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:38:48.508600", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Maths:\n  ID: 3\n  Active: True\n  Time: 08:00:00-12:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:38:48.509079", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term 1 Night:\n  ID: 4\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:38:48.509520", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Term1 Night:\n  ID: 5\n  Active: True\n  Time: 22:00:00-22:40:00\n  Dates: 2025-01-15-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:38:48.510061", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Late Night Study:\n  ID: 6\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2024-01-15-2024-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:38:48.510921", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Late Night Study:\n  ID: 7\n  Active: True\n  Time: 23:00:00-04:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:38:48.511353", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session  Mid-morning:\n  ID: 8\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:38:48.511818", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 60, "message": "Session Late Night Study:\n  ID: 9\n  Active: True\n  Time: 09:00:00-16:00:00\n  Dates: 2025-01-17-2025-04-15\n  School ID: 23"}
{"timestamp": "2025-01-18T07:38:48.515267", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 76, "message": "Sessions after active check: ['Term 1 Session', 'Term 2 Session', 'Maths', 'Term 1 Night', 'Term1 Night', 'Late Night Study', 'Late Night Study', ' Mid-morning', 'Late Night Study']"}
{"timestamp": "2025-01-18T07:38:48.523207", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 85, "message": "Sessions after date check: ['Term1 Night', 'Late Night Study', ' Mid-morning', 'Late Night Study']"}
{"timestamp": "2025-01-18T07:38:48.527480", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 100, "message": "Found 4 potentially active sessions"}
{"timestamp": "2025-01-18T07:38:48.528124", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:38:48 against session 22:00:00-22:40:00"}
{"timestamp": "2025-01-18T07:38:48.528634", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: False"}
{"timestamp": "2025-01-18T07:38:48.529093", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session Term1 Night (ID: 5):\n  Time match: False\n  Day match: False\n  Current time: 10:38:48, Session time: 22:00:00-22:40:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-15, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:38:48.529576", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:38:48 against session 23:00:00-04:00:00"}
{"timestamp": "2025-01-18T07:38:48.529993", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: False"}
{"timestamp": "2025-01-18T07:38:48.530460", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session Late Night Study (ID: 7):\n  Time match: False\n  Day match: False\n  Current time: 10:38:48, Session time: 23:00:00-04:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:38:48.530933", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:38:48 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:38:48.531372", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:38:48.532307", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session  Mid-morning (ID: 8):\n  Time match: True\n  Day match: False\n  Current time: 10:38:48, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:38:48.533936", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:38:48 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:38:48.534705", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:38:48.535623", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 107, "message": "Checking session Late Night Study (ID: 9):\n  Time match: True\n  Day match: True\n  Current time: 10:38:48, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['SATURDAY', 'SUNDAY']\n  Start date: 2025-01-17, End date: 2025-04-15"}
{"timestamp": "2025-01-18T07:38:48.536301", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "get_active_session", "line": 117, "message": "Found matching session: Late Night Study"}
{"timestamp": "2025-01-18T07:38:48.552452", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 125, "message": "Checking time 10:38:48 against session 09:00:00-16:00:00"}
{"timestamp": "2025-01-18T07:38:48.552833", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "_is_time_in_session", "line": 134, "message": "Time check result: True"}
{"timestamp": "2025-01-18T07:38:48.553250", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "attendance_service", "function": "mark_attendance", "line": 221, "message": "Validating session Late Night Study:\n  Time match: True\n  Day match: True\n  Date match: True\n  Current time: 10:38:48, Session time: 09:00:00-16:00:00\n  Current day: SATURDAY, Session days: ['SATURDAY', 'SUNDAY']"}
{"timestamp": "2025-01-18T07:43:02.857793", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T07:43:02.895538", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T07:43:02.941904", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T07:46:30.628031", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T07:46:30.638567", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T07:46:30.662411", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T07:46:30.785218", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "dispatch", "line": 108, "message": "Auth middleware error: 'coroutine' object has no attribute 'scalar_one_or_none'", "exception": {"type": "AttributeError", "message": "'coroutine' object has no attribute 'scalar_one_or_none'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\n", "anyio.WouldBlock\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\n", "AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\n", "anyio.EndOfStream\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/middleware/auth.py\", line 78, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 185, in __call__\n    with collapse_excgroups():\n", "  File \"/usr/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_utils.py\", line 83, in collapse_excgroups\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 187, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/middleware/request_id.py\", line 11, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 62, in wrapped_app\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 51, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 62, in wrapped_app\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 51, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/fastapi/routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/routes/student_management.py\", line 203, in get_students\n    ).scalar_one_or_none()\n      ^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'coroutine' object has no attribute 'scalar_one_or_none'\n"]}}
{"timestamp": "2025-01-18T07:47:48.418901", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T07:47:48.425155", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T07:47:48.445801", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T07:55:08.422213", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T07:55:08.491216", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T07:55:08.554615", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:15:32.665230", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:15:32.701664", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 563, "message": "Unexpected error during token verification", "exception": {"type": "AttributeError", "message": "module 'jose.jwt' has no attribute 'InvalidIssuerError'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 496, in verify_token\n    payload = jwt.decode(\n              ^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 157, in decode\n    _validate_claims(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 481, in _validate_claims\n    _validate_exp(claims, leeway=leeway)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 314, in _validate_exp\n    raise ExpiredSignatureError(\"Signature has expired.\")\n", "jose.exceptions.ExpiredSignatureError: Signature has expired.\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 503, in verify_token\n    except jwt.InvalidIssuerError:\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: module 'jose.jwt' has no attribute 'InvalidIssuerError'\n"]}}
{"timestamp": "2025-01-18T09:15:32.754721", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 1005, "message": "Unexpected error during token validation: 401: Could not validate credentials"}
{"timestamp": "2025-01-18T09:15:32.756053", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "dispatch", "line": 95, "message": "Authentication failed: Token validation failed"}
{"timestamp": "2025-01-18T09:16:10.996542", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 216, "message": "Login attempt initiated", "request_id": "3c2736b8-2e0b-42af-871a-ae1e9b414b08"}
{"timestamp": "2025-01-18T09:16:11.873990", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 710, "message": "Generating tokens", "user_id": "24"}
{"timestamp": "2025-01-18T09:16:11.920205", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 448, "message": "Token created successfully", "user_id": "24"}
{"timestamp": "2025-01-18T09:16:11.922740", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 448, "message": "Token created successfully", "user_id": "24"}
{"timestamp": "2025-01-18T09:16:11.924594", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 727, "message": "Token expiration times"}
{"timestamp": "2025-01-18T09:16:11.927623", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 767, "message": "User logged in successfully", "user_id": "24"}
{"timestamp": "2025-01-18T09:16:11.930864", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 236, "message": "Login successful", "request_id": "3c2736b8-2e0b-42af-871a-ae1e9b414b08", "user_id": "24"}
{"timestamp": "2025-01-18T09:16:48.168889", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:16:48.177376", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:16:48.248385", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:17:33.334028", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:17:33.363798", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:17:33.404074", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:21:49.156454", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:21:49.191446", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:21:49.243628", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:22:01.781993", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:22:01.783854", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:22:01.814617", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:22:36.028254", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:22:36.032592", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:22:36.063743", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:23:00.993937", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:23:00.997427", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:23:01.049716", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:23:16.618764", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:23:16.621240", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:23:16.657315", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:25:34.736715", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:25:34.740310", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:25:34.780116", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:25:34.886277", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "dispatch", "line": 108, "message": "Auth middleware error: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"user_id\" of relation \"parents\" violates not-null constraint\nDETAIL:  Failing row contains (6, null, 23, Mary Smith, +1234567890, mary.smith@email.com, null, 2025-01-18 01:25:34.831469-08, null, 98765432).\n[SQL: INSERT INTO parents (user_id, school_id, name, phone, email, address, id_number, updated_at) VALUES ($1::INTEGER, $2::INTEGER, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::TIMESTAMP WITH TIME ZONE) RETURNING parents.id, parents.created_at]\n[parameters: (None, 23, 'Mary Smith', '+1234567890', 'mary.smith@email.com', None, '98765432', None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "exception": {"type": "IntegrityError", "message": "(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"user_id\" of relation \"parents\" violates not-null constraint\nDETAIL:  Failing row contains (6, null, 23, Mary Smith, +1234567890, mary.smith@email.com, null, 2025-01-18 01:25:34.831469-08, null, 98765432).\n[SQL: INSERT INTO parents (user_id, school_id, name, phone, email, address, id_number, updated_at) VALUES ($1::INTEGER, $2::INTEGER, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::TIMESTAMP WITH TIME ZONE) RETURNING parents.id, parents.created_at]\n[parameters: (None, 23, 'Mary Smith', '+1234567890', 'mary.smith@email.com', None, '98765432', None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 538, in _prepare_and_execute\n    self._rows = deque(await prepared_stmt.fetch(*parameters))\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\n", "asyncpg.exceptions.NotNullViolationError: null value in column \"user_id\" of relation \"parents\" violates not-null constraint\nDETAIL:  Failing row contains (6, null, 23, Mary Smith, +1234567890, mary.smith@email.com, null, 2025-01-18 01:25:34.831469-08, null, 98765432).\n", "\nThe above exception was the direct cause of the following exception:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 572, in execute\n    self._adapt_connection.await_(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 550, in _prepare_and_execute\n    self._handle_exception(error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 501, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 784, in _handle_exception\n    raise translated_error from error\n", "sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"user_id\" of relation \"parents\" violates not-null constraint\nDETAIL:  Failing row contains (6, null, 23, Mary Smith, +1234567890, mary.smith@email.com, null, 2025-01-18 01:25:34.831469-08, null, 98765432).\n", "\nThe above exception was the direct cause of the following exception:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/middleware/auth.py\", line 78, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 185, in __call__\n    with collapse_excgroups():\n", "  File \"/usr/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_utils.py\", line 83, in collapse_excgroups\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 187, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/middleware/request_id.py\", line 11, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 62, in wrapped_app\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 51, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 62, in wrapped_app\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 51, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/fastapi/routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/routes/student_management.py\", line 103, in register_student\n    await db.flush()\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py\", line 800, in flush\n    await greenlet_spawn(self.sync_session.flush, objects=objects)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 572, in execute\n    self._adapt_connection.await_(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 550, in _prepare_and_execute\n    self._handle_exception(error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 501, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 784, in _handle_exception\n    raise translated_error from error\n", "sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"user_id\" of relation \"parents\" violates not-null constraint\nDETAIL:  Failing row contains (6, null, 23, Mary Smith, +1234567890, mary.smith@email.com, null, 2025-01-18 01:25:34.831469-08, null, 98765432).\n[SQL: INSERT INTO parents (user_id, school_id, name, phone, email, address, id_number, updated_at) VALUES ($1::INTEGER, $2::INTEGER, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::TIMESTAMP WITH TIME ZONE) RETURNING parents.id, parents.created_at]\n[parameters: (None, 23, 'Mary Smith', '+1234567890', 'mary.smith@email.com', None, '98765432', None)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\n"]}}
{"timestamp": "2025-01-18T09:26:57.583211", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:26:57.614096", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:26:57.653316", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:28:56.144536", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:28:56.179182", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:28:56.234593", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:28:56.682953", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "dispatch", "line": 108, "message": "Auth middleware error: name 'school' is not defined", "exception": {"type": "NameError", "message": "name 'school' is not defined", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\n", "anyio.WouldBlock\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\n", "AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\n", "anyio.EndOfStream\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/middleware/auth.py\", line 78, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 185, in __call__\n    with collapse_excgroups():\n", "  File \"/usr/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_utils.py\", line 83, in collapse_excgroups\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 187, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/middleware/request_id.py\", line 11, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 62, in wrapped_app\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 51, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 62, in wrapped_app\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 51, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/fastapi/routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/routes/student_management.py\", line 72, in register_student\n    email=f\"student_{student_data.admission_number}@{school.registration_number}.edu\",  # Generate a student email\n                                                     ^^^^^^\n", "NameError: name 'school' is not defined. Did you mean: 'School'?\n"]}}
{"timestamp": "2025-01-18T09:32:31.488897", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:32:31.523235", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:32:31.575861", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:34:05.094112", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:34:05.131132", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:34:05.177384", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:35:29.772756", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:35:29.803759", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:35:29.849272", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:47:38.211695", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:47:38.281391", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "verify_token", "line": 563, "message": "Unexpected error during token verification", "exception": {"type": "AttributeError", "message": "module 'jose.jwt' has no attribute 'InvalidIssuerError'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 496, in verify_token\n    payload = jwt.decode(\n              ^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 157, in decode\n    _validate_claims(\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 481, in _validate_claims\n    _validate_exp(claims, leeway=leeway)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/jose/jwt.py\", line 314, in _validate_exp\n    raise ExpiredSignatureError(\"Signature has expired.\")\n", "jose.exceptions.ExpiredSignatureError: Signature has expired.\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 503, in verify_token\n    except jwt.InvalidIssuerError:\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: module 'jose.jwt' has no attribute 'InvalidIssuerError'\n"]}}
{"timestamp": "2025-01-18T09:47:38.362686", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 1005, "message": "Unexpected error during token validation: 401: Could not validate credentials"}
{"timestamp": "2025-01-18T09:47:38.364050", "level": "WARNING", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "dispatch", "line": 95, "message": "Authentication failed: Token validation failed"}
{"timestamp": "2025-01-18T09:48:15.376482", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 216, "message": "Login attempt initiated", "request_id": "541b0c4d-47c5-41f7-adb8-75d7be39d222"}
{"timestamp": "2025-01-18T09:48:16.085185", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 710, "message": "Generating tokens", "user_id": "24"}
{"timestamp": "2025-01-18T09:48:16.109352", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 448, "message": "Token created successfully", "user_id": "24"}
{"timestamp": "2025-01-18T09:48:16.112448", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "create_token", "line": 448, "message": "Token created successfully", "user_id": "24"}
{"timestamp": "2025-01-18T09:48:16.115376", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 727, "message": "Token expiration times"}
{"timestamp": "2025-01-18T09:48:16.117314", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "authenticate_user", "line": 767, "message": "User logged in successfully", "user_id": "24"}
{"timestamp": "2025-01-18T09:48:16.120501", "level": "INFO", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "login", "line": 236, "message": "Login successful", "request_id": "541b0c4d-47c5-41f7-adb8-75d7be39d222", "user_id": "24"}
{"timestamp": "2025-01-18T09:48:49.857378", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:48:49.863517", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:48:49.935736", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T09:48:51.172803", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth", "function": "dispatch", "line": 108, "message": "Auth middleware error: name 'IntegrityError' is not defined", "exception": {"type": "NameError", "message": "name 'IntegrityError' is not defined", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\n", "anyio.WouldBlock\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\n", "AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\n", "anyio.EndOfStream\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/middleware/auth.py\", line 78, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 185, in __call__\n    with collapse_excgroups():\n", "  File \"/usr/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_utils.py\", line 83, in collapse_excgroups\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 187, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/middleware/request_id.py\", line 11, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 62, in wrapped_app\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 51, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 62, in wrapped_app\n    raise exc\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 51, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/venv/lib/python3.12/site-packages/fastapi/routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/root/projects/school-attendance-management-software/app/routes/student_management.py\", line 199, in register_student\n    except IntegrityError as e:\n           ^^^^^^^^^^^^^^\n", "NameError: name 'IntegrityError' is not defined. Did you mean: 'InterruptedError'?\n"]}}
{"timestamp": "2025-01-18T09:50:48.796718", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T09:50:48.896930", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T09:50:48.970026", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T10:02:04.950897", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T10:02:05.016142", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T10:02:05.074456", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T10:02:20.420059", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T10:02:20.424988", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T10:02:20.462300", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T10:03:23.344877", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T10:03:23.422350", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T10:03:23.555298", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
{"timestamp": "2025-01-18T10:05:13.447181", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 978, "message": "Attempting to verify token"}
{"timestamp": "2025-01-18T10:05:13.519278", "level": "ERROR", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "check_token_revocation", "line": 641, "message": "Failed to check token revocation status", "exception": {"type": "AttributeError", "message": "'_CachedRequest' object has no attribute 'begin'", "traceback": ["Traceback (most recent call last):\n", "  File \"/root/projects/school-attendance-management-software/app/services/auth_service.py\", line 628, in check_token_revocation\n    async with self.db.begin() as transaction:\n               ^^^^^^^^^^^^^\n", "AttributeError: '_CachedRequest' object has no attribute 'begin'\n"]}}
{"timestamp": "2025-01-18T10:05:13.588494", "level": "DEBUG", "logger": "SchoolAttendanceLogger", "module": "auth_service", "function": "validate_token", "line": 998, "message": "Token validated successfully"}
